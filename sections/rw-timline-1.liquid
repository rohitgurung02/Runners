{%- assign sec_id = '#shopify-section-' | append: section.id -%}
{%- assign parts = section.id | split: '-' -%}
{%- assign last_lower = parts | last -%}
{%- assign last_part = last_lower | downcase -%}

<style>
  /* [All your existing CSS remains exactly the same] */
</style>

<pc-timeline-{{ last_part }} class="pc-timeline-{{ last_part }}">
  <!-- [All your existing HTML remains exactly the same] -->
</pc-timeline-{{ last_part }}>

<script>
(function() {
  // Wait until the DOM is fully loaded
  document.addEventListener('DOMContentLoaded', function() {
    // Get the unique section ID
    const sectionId = '{{ sec_id }}';
    
    // Initialize all hidden boxes
    const hiddenBoxes = document.querySelectorAll(`${sectionId} .pc-timeline-hidden-box-${'{{ last_part }}'}`);
    hiddenBoxes.forEach(box => {
      box.style.display = 'none';
    });
    
    // Add click event to all toggle buttons
    const toggleButtons = document.querySelectorAll(`${sectionId} .pc-timeline-toggle-${'{{ last_part }}'}`);
    
    toggleButtons.forEach(button => {
      button.addEventListener('click', function(e) {
        e.preventDefault();
        const contentBox = this.closest('.pc-timeline-content-{{ last_part }}');
        const hiddenBox = contentBox.querySelector('.pc-timeline-hidden-box-{{ last_part }}');
        
        // Toggle the active class
        this.classList.toggle('active');
        
        // Toggle the display
        if (hiddenBox.style.display === 'none') {
          hiddenBox.style.display = 'block';
        } else {
          hiddenBox.style.display = 'none';
        }
      });
    });
  });
})();
</script>

{% schema %}
{
  "name": "RW - Timeline #1",
  "settings": [
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "primary_color",
      "label": "Primary Color",
      "default": "#FE5000"
    },
    {
      "type": "color",
      "id": "secondary_color",
      "label": "Secondary Color",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#6E6E6E"
    },
    {
      "type": "color",
      "id": "line_color",
      "label": "Line Color",
      "default": "#FE5000"
    },
    {
      "type": "color",
      "id": "date_bg_color",
      "label": "Date Background Color",
      "default": "#FE5000"
    },
    {
      "type": "color",
      "id": "date_text_color",
      "label": "Date Text Color",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "small_date_bg_color",
      "label": "Small Date Background Color",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "small_date_text_color",
      "label": "Small Date Text Color",
      "default": "#FE5000"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "container_width",
      "label": "Container Width",
      "min": 800,
      "max": 1600,
      "step": 20,
      "unit": "px",
      "default": 1200
    },
    {
      "type": "range",
      "id": "content_width",
      "label": "Content Width",
      "min": 300,
      "max": 800,
      "step": 10,
      "unit": "px",
      "default": 460
    },
    {
      "type": "range",
      "id": "line_width",
      "label": "Line Width",
      "min": 1,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "range",
      "id": "connector_width",
      "label": "Connector Width",
      "min": 50,
      "max": 200,
      "step": 5,
      "unit": "px",
      "default": 50
    },
    {
      "type": "range",
      "id": "connector_height",
      "label": "Connector Height",
      "min": 5,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 21
    },
    {
      "type": "range",
      "id": "connector_margin_top",
      "label": "Connector Margin Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 41
    },
    {
      "type": "range",
      "id": "date_size",
      "label": "Date Circle Size",
      "min": 50,
      "max": 150,
      "step": 5,
      "unit": "px",
      "default": 100
    },
    {
      "type": "range",
      "id": "small_date_size",
      "label": "Small Date Circle Size",
      "min": 30,
      "max": 100,
      "step": 2,
      "unit": "px",
      "default": 46
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "year_font_size",
      "label": "Year Font Size",
      "min": 10,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "select",
      "id": "year_font_weight",
      "label": "Year Font Weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "700"
    },
    {
      "type": "range",
      "id": "year_letter_spacing",
      "label": "Year Letter Spacing",
      "min": 0,
      "max": 1,
      "step": 0.1,
      "unit": "px",
      "default": 0.4
    },
    {
      "type": "range",
      "id": "year_margin_bottom",
      "label": "Year Margin Bottom",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "range",
      "id": "title_font_size",
      "label": "Title Font Size",
      "min": 16,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 25
    },
    {
      "type": "select",
      "id": "title_font_weight",
      "label": "Title Font Weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "700"
    },
    {
      "type": "range",
      "id": "title_letter_spacing",
      "label": "Title Letter Spacing",
      "min": 0,
      "max": 1,
      "step": 0.1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "title_line_height",
      "label": "Title Line Height",
      "min": 1,
      "max": 2,
      "step": 0.1,
      "default": 1.2
    },
    {
      "type": "range",
      "id": "title_margin_bottom",
      "label": "Title Margin Bottom",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 18
    },
    {
      "type": "range",
      "id": "description_font_size",
      "label": "Description Font Size",
      "min": 10,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 13
    },
    {
      "type": "range",
      "id": "description_line_height",
      "label": "Description Line Height",
      "min": 1,
      "max": 2,
      "step": 0.1,
      "default": 1.8
    },
    {
      "type": "range",
      "id": "date_font_size",
      "label": "Date Font Size",
      "min": 10,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 30
    },
    {
      "type": "select",
      "id": "date_font_weight",
      "label": "Date Font Weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "700",
          "label": "Bold"
        },
        {
          "value": "900",
          "label": "Black"
        }
      ],
      "default": "900"
    },
    {
      "type": "range",
      "id": "small_date_font_size",
      "label": "Small Date Font Size",
      "min": 8,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 14
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "step_padding_top",
      "label": "Step Padding Top",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 50
    },
    {
      "type": "range",
      "id": "content_padding",
      "label": "Content Padding",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 24
    },
    {
      "type": "range",
      "id": "content_margin_bottom",
      "label": "Content Margin Bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "steps_margin_top",
      "label": "Steps Margin Top",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "desktop_margin_top",
      "label": "Margin Top (Desktop)",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "desktop_margin_bottom",
      "label": "Margin Bottom (Desktop)",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "desktop_padding_top",
      "label": "Padding Top (Desktop)",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "desktop_padding_bottom",
      "label": "Padding Bottom (Desktop)",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "header",
      "content": "Mobile Settings"
    },
    {
      "type": "range",
      "id": "mobile_margin_top",
      "label": "Margin Top (Mobile)",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "mobile_margin_bottom",
      "label": "Margin Bottom (Mobile)",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "mobile_padding_top",
      "label": "Padding Top (Mobile)",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "mobile_padding_bottom",
      "label": "Padding Bottom (Mobile)",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "mobile_content_padding",
      "label": "Content Padding (Mobile)",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "range",
      "id": "mobile_year_font_size",
      "label": "Year Font Size (Mobile)",
      "min": 10,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 14
    },
    {
      "type": "range",
      "id": "mobile_title_font_size",
      "label": "Title Font Size (Mobile)",
      "min": 14,
      "max": 40,
      "step": 1,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "mobile_description_font_size",
      "label": "Description Font Size (Mobile)",
      "min": 10,
      "max": 18,
      "step": 1,
      "unit": "px",
      "default": 12
    },
    {
      "type": "range",
      "id": "mobile_date_font_size",
      "label": "Date Font Size (Mobile)",
      "min": 10,
      "max": 40,
      "step": 1,
      "unit": "px",
      "default": 24
    },
    {
      "type": "range",
      "id": "mobile_date_size",
      "label": "Date Circle Size (Mobile)",
      "min": 40,
      "max": 120,
      "step": 5,
      "unit": "px",
      "default": 80
    },
    {
      "type": "range",
      "id": "mobile_small_date_font_size",
      "label": "Small Date Font Size (Mobile)",
      "min": 8,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 12
    },
    {
      "type": "range",
      "id": "mobile_small_date_size",
      "label": "Small Date Circle Size (Mobile)",
      "min": 30,
      "max": 80,
      "step": 2,
      "unit": "px",
      "default": 40
    }
  ],
  "blocks": [
    {
      "type": "timeline_item",
      "name": "Timeline Item",
      "settings": [
        {
          "type": "text",
          "id": "year",
          "label": "Year",
          "default": "2021"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Lorem ipsum dolor"
        },
        {
          "type": "richtext",
          "id": "description",
          "label": "Description",
          "default": "<p>Lorem ipsum dolor sit amet, quo ei simul congue exerci, ad nec admodum perfecto mnesarchum, vim ea mazim fierent detracto. Ea quis iuvaret expetendis his, te elit voluptua dignissim per, habeo iusto primis ea eam.</p>"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "date",
          "label": "Date",
          "default": "2000"
        },
        {
          "type": "select",
          "id": "date_size",
          "label": "Date Size",
          "options": [
            {
              "value": "normal",
              "label": "Normal"
            },
            {
              "value": "small",
              "label": "Small"
            }
          ],
          "default": "normal"
        },
        {
          "type": "select",
          "id": "background_color",
          "label": "Background Color",
          "options": [
            {
              "value": "orange",
              "label": "Primary Color"
            },
            {
              "value": "white",
              "label": "Secondary Color"
            }
          ],
          "default": "orange"
        },
        {
          "type": "select",
          "id": "alignment",
          "label": "Alignment",
          "options": [
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "center",
              "label": "Center"
            }
          ],
          "default": "right"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "RW - Timeline #1",
      "category": "Custom",
      "blocks": [
        {
          "type": "timeline_item",
          "settings": {
            "year": "2021",
            "title": "Lorem ipsum dolor",
            "description": "<p>Lorem ipsum dolor sit amet, quo ei simul congue exerci, ad nec admodum perfecto mnesarchum, vim ea mazim fierent detracto. Ea quis iuvaret expetendis his, te elit voluptua dignissim per, habeo iusto primis ea eam.</p>",
            "date": "2000",
            "date_size": "normal",
            "background_color": "orange",
            "alignment": "right"
          }
        },
        {
          "type": "timeline_item",
          "settings": {
            "year": "1996",
            "title": "Lorem ipsum dolor",
            "description": "<p>Lorem ipsum dolor sit amet, quo ei simul congue exerci, ad nec admodum perfecto mnesarchum, vim ea mazim fierent detracto. Ea quis iuvaret expetendis his, te elit voluptua dignissim per, habeo iusto primis ea eam.</p>",
            "date": "1996",
            "date_size": "small",
            "background_color": "white",
            "alignment": "left"
          }
        },
        {
          "type": "timeline_item",
          "settings": {
            "year": "2000",
            "title": "Lorem ipsum dolor",
            "description": "<p>Lorem ipsum dolor sit amet, quo ei simul congue exerci, ad nec admodum perfecto mnesarchum, vim ea mazim fierent detracto. Ea quis iuvaret expetendis his, te elit voluptua dignissim per, habeo iusto primis ea eam.</p>",
            "date": "2000",
            "date_size": "normal",
            "background_color": "orange",
            "alignment": "right"
          }
        }
      ]
    }
  ]
}
{% endschema %}