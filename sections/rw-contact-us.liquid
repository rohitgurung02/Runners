{%- assign sec_id = '#shopify-section-' | append: section.id -%}
{%- assign parts = sec_id | split: '_' -%}
{%- assign last_lower = parts | last -%}
{%- assign last_part = last_lower | downcase -%}

<style>
  {{ sec_id }} .pc-contact-form-{{ last_part }} {
    position: relative;
    width: 100%;
    overflow: hidden;
  }

  {{ sec_id }} .pc-contact-container-{{ last_part }} {
    display: flex;
    width: 100%;
    min-height: 100vh;
    background: var(--pc-bg-color-{{ last_part }});
  }

  {{ sec_id }} .pc-left-col-{{ last_part }} {
    width: 45%;
    min-height: 100vh;
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
  }

  {{ sec_id }} .pc-logo-{{ last_part }} {
    width: 10rem;
    padding: 1.5rem;
  }

  {{ sec_id }} .pc-right-col-{{ last_part }} {
    background: var(--pc-bg-color-{{ last_part }});
    width: 55%;
    padding: 5rem 3.5rem;
  }

  {{ sec_id }} h1.pc-heading-{{ last_part }},
  {{ sec_id }} label.pc-label-{{ last_part }},
  {{ sec_id }} button.pc-button-{{ last_part }},
  {{ sec_id }} .pc-description-{{ last_part }} {
    font-family: inherit;
    font-weight: 400;
    letter-spacing: 0.1rem;
  }

  {{ sec_id }} h1.pc-heading-{{ last_part }} {
    color: var(--pc-heading-color-{{ last_part }});
    text-transform: uppercase;
    font-size: 2.5rem;
    letter-spacing: 0.5rem;
    font-weight: 300;
    margin-bottom: 1.5rem;
  }

  {{ sec_id }} .pc-description-{{ last_part }} {
    color: var(--pc-secondary-color-{{ last_part }});
    font-size: 0.9rem;
    letter-spacing: 0.01rem;
    width: 100%;
    margin: 0.25rem 0 2rem;
    line-height: 1.5;
  }

  {{ sec_id }} label.pc-label-{{ last_part }},
  {{ sec_id }} .pc-description-{{ last_part }} {
    color: var(--pc-secondary-color-{{ last_part }});
    text-transform: uppercase;
    font-size: 0.625rem;
    margin-bottom: 0.5rem;
    display: block;
  }

  {{ sec_id }} .pc-form-{{ last_part }} {
    width: 100%;
    position: relative;
    margin-top: 2rem;
    padding: 1rem 0;
  }

  {{ sec_id }} .pc-input-{{ last_part }},
  {{ sec_id }} .pc-textarea-{{ last_part }} {
    color: var(--pc-primary-color-{{ last_part }});
    font-weight: 500;
    background: var(--pc-bg-color-{{ last_part }});
    border: none;
    border-bottom: 1px solid var(--pc-secondary-color-{{ last_part }});
    padding: 0.5rem 0;
    margin-bottom: 1.5rem;
    outline: none;
    width: 100%;
    font-family: inherit;
  }

  {{ sec_id }} .pc-textarea-{{ last_part }} {
    resize: none;
  }

  {{ sec_id }} .pc-button-{{ last_part }} {
    text-transform: uppercase;
    font-weight: 300;
    background: var(--pc-button-color-{{ last_part }});
    color: var(--pc-bg-color-{{ last_part }});
    width: 10rem;
    height: 2.25rem;
    border: none;
    border-radius: 2px;
    outline: none;
    cursor: pointer;
    margin-top: 1rem;
  }

  {{ sec_id }} .pc-input-{{ last_part }}:hover,
  {{ sec_id }} .pc-textarea-{{ last_part }}:hover,
  {{ sec_id }} .pc-button-{{ last_part }}:hover {
    opacity: 0.5;
  }

  {{ sec_id }} .pc-button-{{ last_part }}:active {
    opacity: 0.8;
  }

  {{ sec_id }} .pc-theme-switch-wrapper-{{ last_part }} {
    display: flex;
    align-items: center;
    text-align: center;
    width: 160px;
    position: absolute;
    top: 0.5rem;
    right: 0;
  }

  {{ sec_id }} .pc-description-{{ last_part }} {
    margin-left: 1.25rem;
  }

  {{ sec_id }} .pc-theme-switch-{{ last_part }} {
    display: inline-block;
    height: 34px;
    position: relative;
    width: 60px;
  }

  {{ sec_id }} .pc-theme-switch-{{ last_part }} input {
    display: none;
  }

  {{ sec_id }} .pc-slider-{{ last_part }} {
    background-color: #ccc;
    bottom: 0;
    cursor: pointer;
    left: 0;
    position: absolute;
    right: 0;
    top: 0;
    transition: .4s;
  }

  {{ sec_id }} .pc-slider-{{ last_part }}:before {
    background-color: #fff;
    bottom: 0.25rem;
    content: "";
    width: 26px;
    height: 26px;
    left: 0.25rem;
    position: absolute;
    transition: .4s;
  }

  {{ sec_id }} .pc-theme-switch-{{ last_part }} input:checked + .pc-slider-{{ last_part }} {
    background-color: var(--pc-button-color-{{ last_part }});
  }

  {{ sec_id }} .pc-theme-switch-{{ last_part }} input:checked + .pc-slider-{{ last_part }}:before {
    transform: translateX(26px);
  }

  {{ sec_id }} .pc-slider-{{ last_part }}.pc-round-{{ last_part }} {
    border-radius: 34px;
  }

  {{ sec_id }} .pc-slider-{{ last_part }}.pc-round-{{ last_part }}:before {
    border-radius: 50%;
  }

  {{ sec_id }} .pc-error-{{ last_part }},
  {{ sec_id }} .pc-success-msg-{{ last_part }} {
    width: 100%;
    margin: 0.125rem 0;
    font-size: 0.75rem;
    text-transform: uppercase;
    font-family: inherit;
    color: var(--pc-secondary-color-{{ last_part }});
  }

  {{ sec_id }} .pc-success-msg-{{ last_part }} {
    transition-delay: 3s;
  }

  @media only screen and (max-width: 950px) {
    {{ sec_id }} .pc-contact-container-{{ last_part }} {
      flex-direction: column;
    }

    {{ sec_id }} .pc-left-col-{{ last_part }},
    {{ sec_id }} .pc-right-col-{{ last_part }} {
      width: 100%;
      min-height: auto;
    }

    {{ sec_id }} .pc-left-col-{{ last_part }} {
      height: 40vh;
    }

    {{ sec_id }} .pc-right-col-{{ last_part }} {
      padding: 3rem 1.5rem;
    }

    {{ sec_id }} h1.pc-heading-{{ last_part }} {
      font-size: 1.75rem;
    }

    {{ sec_id }} .pc-description-{{ last_part }} {
      font-size: 0.8rem;
    }

    {{ sec_id }} .pc-theme-switch-wrapper-{{ last_part }} {
      width: 120px;
    }

    {{ sec_id }} .pc-theme-switch-{{ last_part }} {
      height: 28px;
      width: 50px;
    }

    {{ sec_id }} .pc-slider-{{ last_part }}:before {
      width: 20px;
      height: 20px;
    }

    {{ sec_id }} .pc-theme-switch-{{ last_part }} input:checked + .pc-slider-{{ last_part }}:before {
      transform: translateX(16px);
    }
  }
</style>

<pc-contact-form-{{ last_part }} class="pc-contact-form-{{ last_part }}">
  <div class="pc-contact-container-{{ last_part }}">
    <div class="pc-left-col-{{ last_part }}" style="background-image: url('{{ section.settings.image | image_url: width: 1500 }}');">
      {%- if section.settings.logo -%}
        <img class="pc-logo-{{ last_part }}" src="{{ section.settings.logo | image_url: width: 300 }}" alt="{{ section.settings.logo.alt | escape }}">
      {%- endif -%}
    </div>
    <div class="pc-right-col-{{ last_part }}">
      <div class="pc-theme-switch-wrapper-{{ last_part }}">
        <label class="pc-theme-switch-{{ last_part }}" for="pc-checkbox-{{ last_part }}">
          <input type="checkbox" id="pc-checkbox-{{ last_part }}" class="pc-theme-toggle-{{ last_part }}">
          <div class="pc-slider-{{ last_part }} pc-round-{{ last_part }}"></div>
        </label>
        <div class="pc-description-{{ last_part }}">Dark Mode</div>
      </div>
      
      <h1 class="pc-heading-{{ last_part }}">{{ section.settings.heading }}</h1>
      <p class="pc-description-{{ last_part }}">{{ section.settings.description }}</p>
      
      <form id="pc-contact-form-{{ last_part }}" class="pc-form-{{ last_part }}" method="post">
        <label for="pc-name-{{ last_part }}" class="pc-label-{{ last_part }}">Full name</label>
        <input type="text" id="pc-name-{{ last_part }}" class="pc-input-{{ last_part }}" name="name" placeholder="{{ section.settings.name_placeholder }}" required>
        
        <label for="pc-email-{{ last_part }}" class="pc-label-{{ last_part }}">Email Address</label>
        <input type="email" id="pc-email-{{ last_part }}" class="pc-input-{{ last_part }}" name="email" placeholder="{{ section.settings.email_placeholder }}" required>
        
        <label for="pc-message-{{ last_part }}" class="pc-label-{{ last_part }}">Message</label>
        <textarea rows="6" id="pc-message-{{ last_part }}" class="pc-textarea-{{ last_part }}" name="message" placeholder="{{ section.settings.message_placeholder }}" required></textarea>
        
        <button type="submit" id="pc-submit-{{ last_part }}" class="pc-button-{{ last_part }}">{{ section.settings.button_text }}</button>
      </form>
      
      <div id="pc-error-{{ last_part }}" class="pc-error-{{ last_part }}"></div>
      <div id="pc-success-msg-{{ last_part }}" class="pc-success-msg-{{ last_part }}"></div>
    </div>
  </div>
</pc-contact-form-{{ last_part }}>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const toggleSwitch = document.querySelector('#{{ sec_id }} .pc-theme-toggle-{{ last_part }}');
    const form = document.getElementById('pc-contact-form-{{ last_part }}');
    const errorElement = document.getElementById('pc-error-{{ last_part }}');
    const successMsg = document.getElementById('pc-success-msg-{{ last_part }}');
    const submitBtn = document.getElementById('pc-submit-{{ last_part }}');

    function switchTheme(e) {
      if (e.target.checked) {
        document.documentElement.setAttribute('data-pc-theme-{{ last_part }}', 'dark');
      } else {
        document.documentElement.setAttribute('data-pc-theme-{{ last_part }}', 'light');
      }
    }

    if (toggleSwitch) {
      toggleSwitch.addEventListener('change', switchTheme, false);
    }

    function emailIsValid(email) {
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }

    function validate(e) {
      e.preventDefault();
      errorElement.textContent = '';
      successMsg.textContent = '';

      const name = document.getElementById('pc-name-{{ last_part }}').value;
      const email = document.getElementById('pc-email-{{ last_part }}').value;
      const message = document.getElementById('pc-message-{{ last_part }}').value;

      if (name.length < 3) {
        errorElement.textContent = '{{ section.settings.name_error }}';
        return false;
      }

      if (!emailIsValid(email)) {
        errorElement.textContent = '{{ section.settings.email_error }}';
        return false;
      }

      if (message.length < 15) {
        errorElement.textContent = '{{ section.settings.message_error }}';
        return false;
      }

      successMsg.textContent = '{{ section.settings.success_message }}';

      setTimeout(function() {
        successMsg.textContent = '';
        form.reset();
      }, 6000);

      return true;
    }

    if (form && submitBtn) {
      form.addEventListener('submit', validate);
    }
  });
</script>

{% schema %}
{
  "name": "RW Contact Form",
  "tag": "section",
  "class": "shopify-section--contact-form",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Background Image",
      "info": "Recommended size: 1500x1000px"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Contact us"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Planning to visit Indonesia soon? Get insider tips on where to go, things to do and find best deals for your next adventure."
    },
    {
      "type": "text",
      "id": "name_placeholder",
      "label": "Name Placeholder",
      "default": "Your Full Name"
    },
    {
      "type": "text",
      "id": "email_placeholder",
      "label": "Email Placeholder",
      "default": "Your Email Address"
    },
    {
      "type": "text",
      "id": "message_placeholder",
      "label": "Message Placeholder",
      "default": "Your Message"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Send"
    },
    {
      "type": "text",
      "id": "name_error",
      "label": "Name Error Message",
      "default": "Your name should be at least 3 characters long."
    },
    {
      "type": "text",
      "id": "email_error",
      "label": "Email Error Message",
      "default": "Please enter a valid email address."
    },
    {
      "type": "text",
      "id": "message_error",
      "label": "Message Error Message",
      "default": "Please write a longer message (at least 15 characters)."
    },
    {
      "type": "text",
      "id": "success_message",
      "label": "Success Message",
      "default": "Thank you! We will get back to you as soon as possible."
    },
    {
      "type": "header",
      "content": "Colors (Light Mode)"
    },
    {
      "type": "color",
      "id": "primary_color_light",
      "label": "Primary Color",
      "default": "#010712"
    },
    {
      "type": "color",
      "id": "secondary_color_light",
      "label": "Secondary Color",
      "default": "#818386"
    },
    {
      "type": "color",
      "id": "bg_color_light",
      "label": "Background Color",
      "default": "#FCFDFD"
    },
    {
      "type": "color",
      "id": "button_color_light",
      "label": "Button Color",
      "default": "#3B3636"
    },
    {
      "type": "color",
      "id": "heading_color_light",
      "label": "Heading Color",
      "default": "#3F444C"
    },
    {
      "type": "header",
      "content": "Colors (Dark Mode)"
    },
    {
      "type": "color",
      "id": "primary_color_dark",
      "label": "Primary Color",
      "default": "#FCFDFD"
    },
    {
      "type": "color",
      "id": "secondary_color_dark",
      "label": "Secondary Color",
      "default": "#818386"
    },
    {
      "type": "color",
      "id": "bg_color_dark",
      "label": "Background Color",
      "default": "#010712"
    },
    {
      "type": "color",
      "id": "button_color_dark",
      "label": "Button Color",
      "default": "#818386"
    },
    {
      "type": "color",
      "id": "heading_color_dark",
      "label": "Heading Color",
      "default": "#FCFDFD"
    },
    {
      "type": "header",
      "content": "Spacing (Desktop)"
    },
    {
      "type": "range",
      "id": "desktop_padding_top",
      "label": "Top Padding",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "desktop_padding_bottom",
      "label": "Bottom Padding",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "desktop_padding_left",
      "label": "Left Padding",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "desktop_padding_right",
      "label": "Right Padding",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "header",
      "content": "Spacing (Mobile)"
    },
    {
      "type": "range",
      "id": "mobile_padding_top",
      "label": "Top Padding",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "mobile_padding_bottom",
      "label": "Bottom Padding",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "mobile_padding_left",
      "label": "Left Padding",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "mobile_padding_right",
      "label": "Right Padding",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    }
  ],
  "presets": [
    {
      "name": "RW Contact Form",
      "category": "Custom"
    }
  ]
}
{% endschema %}

<style>
  :root {
    --pc-primary-color-{{ last_part }}: {{ section.settings.primary_color_light }};
    --pc-secondary-color-{{ last_part }}: {{ section.settings.secondary_color_light }};
    --pc-bg-color-{{ last_part }}: {{ section.settings.bg_color_light }};
    --pc-button-color-{{ last_part }}: {{ section.settings.button_color_light }};
    --pc-heading-color-{{ last_part }}: {{ section.settings.heading_color_light }};
  }

  [data-pc-theme-{{ last_part }}="dark"] {
    --pc-primary-color-{{ last_part }}: {{ section.settings.primary_color_dark }};
    --pc-secondary-color-{{ last_part }}: {{ section.settings.secondary_color_dark }};
    --pc-bg-color-{{ last_part }}: {{ section.settings.bg_color_dark }};
    --pc-button-color-{{ last_part }}: {{ section.settings.button_color_dark }};
    --pc-heading-color-{{ last_part }}: {{ section.settings.heading_color_dark }};
  }

  {{ sec_id }} {
    padding-top: {{ section.settings.desktop_padding_top }}px;
    padding-bottom: {{ section.settings.desktop_padding_bottom }}px;
    padding-left: {{ section.settings.desktop_padding_left }}px;
    padding-right: {{ section.settings.desktop_padding_right }}px;
  }

  @media screen and (max-width: 768px) {
    {{ sec_id }} {
      padding-top: {{ section.settings.mobile_padding_top }}px;
      padding-bottom: {{ section.settings.mobile_padding_bottom }}px;
      padding-left: {{ section.settings.mobile_padding_left }}px;
      padding-right: {{ section.settings.mobile_padding_right }}px;
    }
  }
</style>