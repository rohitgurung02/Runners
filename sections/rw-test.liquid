{%- assign sec_id = '#shopify-section-' | append: section.id -%}
{%- assign parts = sec_id | split: '_' -%}
{%- assign last_lower = parts | last -%}
{%- assign last_part = last_lower | downcase -%}

<style>
  {{ sec_id }} {
    background-color: {{ section.settings.background_color }};
    padding: {{ section.settings.section_padding }}px 0;
    font-family: {{ section.settings.font_family }};
  }

  {{ sec_id }} .pc-container-{{ last_part }} {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
  }

  {{ sec_id }} .pc-slider-{{ last_part }} {
    position: relative;
    width: 100%;
    overflow: hidden;
  }

  {{ sec_id }} .pc-slides-container-{{ last_part }} {
    display: flex;
    transition: transform 0.5s ease;
    width: 100%;
  }

  {{ sec_id }} .pc-slide-{{ last_part }} {
    min-width: calc(100% / {{ section.settings.slides_to_show }});
    padding: 0 {{ section.settings.slide_gap | divided_by: 2 }}px;
    box-sizing: border-box;
  }

  {{ sec_id }} .pc-card-{{ last_part }} {
    background-color: {{ section.settings.card_bg_color }};
    border-radius: {{ section.settings.card_border_radius }}px;
    padding: {{ section.settings.card_padding }}px;
    height: 100%;
    display: flex;
    flex-direction: column;
    {% if section.settings.enable_shadow %}
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    {% endif %}
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  {{ sec_id }} .pc-card-{{ last_part }}:hover {
    transform: translateY(-5px);
    {% if section.settings.enable_shadow %}
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    {% endif %}
  }

  {{ sec_id }} .pc-card-header-{{ last_part }} {
    margin-bottom: {{ section.settings.content_spacing }}px;
  }

  {{ sec_id }} .pc-card-title-{{ last_part }} {
    font-size: {{ section.settings.heading_font_size }}px;
    color: {{ section.settings.heading_color }};
    font-weight: {{ section.settings.heading_font_weight }};
    margin: 0 0 10px 0;
    line-height: 1.3;
  }

  {{ sec_id }} .pc-card-content-{{ last_part }} {
    font-size: {{ section.settings.text_font_size }}px;
    color: {{ section.settings.text_color }};
    line-height: 1.5;
    margin: 0;
  }

  {{ sec_id }} .pc-nav-button-{{ last_part }} {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: {{ section.settings.nav_button_size }}px;
    height: {{ section.settings.nav_button_size }}px;
    background-color: {{ section.settings.nav_button_bg_color }};
    color: {{ section.settings.nav_button_color }};
    border: none;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 10;
    opacity: {{ section.settings.nav_button_opacity }};
    transition: opacity 0.3s ease;
  }

  {{ sec_id }} .pc-nav-button-{{ last_part }}:hover {
    opacity: 1;
  }

  {{ sec_id }} .pc-next-button-{{ last_part }} {
    right: 10px;
  }

  {{ sec_id }} .pc-prev-button-{{ last_part }} {
    left: 10px;
  }

  {{ sec_id }} .pc-nav-icon-{{ last_part }} {
    width: 16px;
    height: 16px;
  }

  {{ sec_id }} .pc-dots-{{ last_part }} {
    display: flex;
    justify-content: center;
    margin-top: 20px;
  }

  {{ sec_id }} .pc-dot-{{ last_part }} {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background-color: {{ section.settings.dot_color }};
    margin: 0 5px;
    cursor: pointer;
    opacity: 0.5;
    transition: opacity 0.3s ease;
  }

  {{ sec_id }} .pc-dot-{{ last_part }}.active {
    opacity: 1;
  }

  @media (max-width: 768px) {
    {{ sec_id }} {
      padding: {{ section.settings.mobile_section_padding }}px 0;
    }
    
    {{ sec_id }} .pc-slide-{{ last_part }} {
      min-width: calc(100% / {{ section.settings.mobile_slides_to_show }});
    }
    
    {{ sec_id }} .pc-card-title-{{ last_part }} {
      font-size: {{ section.settings.mobile_heading_font_size }}px;
    }
    
    {{ sec_id }} .pc-card-content-{{ last_part }} {
      font-size: {{ section.settings.mobile_text_font_size }}px;
    }
    
    {{ sec_id }} .pc-nav-button-{{ last_part }} {
      width: {{ section.settings.mobile_nav_button_size }}px;
      height: {{ section.settings.mobile_nav_button_size }}px;
    }
    
    {{ sec_id }} .pc-nav-icon-{{ last_part }} {
      width: 12px;
      height: 12px;
    }
  }
</style>

<div class="pc-container-{{ last_part }}">
  <div class="pc-slider-{{ last_part }}">
    <div class="pc-slides-container-{{ last_part }}" id="pc-slides-container-{{ last_part }}">
      {% for block in section.blocks %}
        <div class="pc-slide-{{ last_part }}">
          <div class="pc-card-{{ last_part }}">
            <div class="pc-card-header-{{ last_part }}">
              <h3 class="pc-card-title-{{ last_part }}">{{ block.settings.title }}</h3>
            </div>
            <div class="pc-card-content-{{ last_part }}">
              <p>{{ block.settings.content }}</p>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
    
    <button class="pc-nav-button-{{ last_part }} pc-prev-button-{{ last_part }}" id="pc-prev-{{ last_part }}">
      <svg class="pc-nav-icon-{{ last_part }}" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
    <button class="pc-nav-button-{{ last_part }} pc-next-button-{{ last_part }}" id="pc-next-{{ last_part }}">
      <svg class="pc-nav-icon-{{ last_part }}" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
  </div>
  
  <div class="pc-dots-{{ last_part }}" id="pc-dots-{{ last_part }}"></div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const secId = '{{ sec_id }}';
    const lastPart = '{{ last_part }}';
    const slidesContainer = document.getElementById(`pc-slides-container-${lastPart}`);
    const slides = document.querySelectorAll(`${secId} .pc-slide-${lastPart}`);
    const prevBtn = document.getElementById(`pc-prev-${lastPart}`);
    const nextBtn = document.getElementById(`pc-next-${lastPart}`);
    const dotsContainer = document.getElementById(`pc-dots-${lastPart}`);
    
    let currentIndex = 0;
    const slidesToShow = {{ section.settings.slides_to_show }};
    const mobileSlidesToShow = {{ section.settings.mobile_slides_to_show }};
    let activeSlidesToShow = window.innerWidth <= 768 ? mobileSlidesToShow : slidesToShow;
    
    // Create dots
    slides.forEach((slide, index) => {
      const dot = document.createElement('div');
      dot.classList.add(`pc-dot-${lastPart}`);
      if (index === 0) dot.classList.add('active');
      dot.addEventListener('click', () => {
        goToSlide(index);
      });
      dotsContainer.appendChild(dot);
    });
    
    // Update slides on window resize
    window.addEventListener('resize', updateSlider);
    
    // Navigation buttons
    if (prevBtn) {
      prevBtn.addEventListener('click', () => {
        if (currentIndex > 0) {
          goToSlide(currentIndex - 1);
        }
      });
    }
    
    if (nextBtn) {
      nextBtn.addEventListener('click', () => {
        if (currentIndex < slides.length - activeSlidesToShow) {
          goToSlide(currentIndex + 1);
        }
      });
    }
    
    function updateSlider() {
      activeSlidesToShow = window.innerWidth <= 768 ? mobileSlidesToShow : slidesToShow;
      goToSlide(currentIndex);
    }
    
    function goToSlide(index) {
      currentIndex = index;
      const slideWidth = slides[0].offsetWidth;
      slidesContainer.style.transform = `translateX(-${currentIndex * slideWidth}px)`;
      
      // Update dots
      const dots = document.querySelectorAll(`${secId} .pc-dot-${lastPart}`);
      dots.forEach((dot, i) => {
        dot.classList.toggle('active', i === currentIndex);
      });
      
      // Toggle navigation buttons
      if (prevBtn) {
        prevBtn.style.display = currentIndex === 0 ? 'none' : 'flex';
      }
      if (nextBtn) {
        nextBtn.style.display = currentIndex >= slides.length - activeSlidesToShow ? 'none' : 'flex';
      }
    }
    
    // Initialize
    updateSlider();
  });
</script>

{% schema %}
{
  "name": "PWC - Card Carousel #1",
  "settings": [
    {
      "type": "header",
      "content": "Section Settings"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#f8f9fa"
    },
    {
      "type": "range",
      "id": "section_padding",
      "label": "Section Padding (Desktop)",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "mobile_section_padding",
      "label": "Section Padding (Mobile)",
      "min": 0,
      "max": 60,
      "step": 5,
      "unit": "px",
      "default": 20
    },
    {
      "type": "select",
      "id": "font_family",
      "label": "Font Family",
      "options": [
        {
          "value": "Arial, sans-serif",
          "label": "Arial"
        },
        {
          "value": "'Helvetica Neue', sans-serif",
          "label": "Helvetica"
        },
        {
          "value": "Georgia, serif",
          "label": "Georgia"
        },
        {
          "value": "'Times New Roman', serif",
          "label": "Times New Roman"
        },
        {
          "value": "'Courier New', monospace",
          "label": "Courier New"
        }
      ],
      "default": "Arial, sans-serif"
    },
    {
      "type": "header",
      "content": "Slider Settings"
    },
    {
      "type": "range",
      "id": "slides_to_show",
      "label": "Slides to Show (Desktop)",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 3
    },
    {
      "type": "range",
      "id": "mobile_slides_to_show",
      "label": "Slides to Show (Mobile)",
      "min": 1,
      "max": 3,
      "step": 1,
      "default": 1
    },
    {
      "type": "range",
      "id": "slide_gap",
      "label": "Slide Gap",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "default": 20
    },
    {
      "type": "header",
      "content": "Card Settings"
    },
    {
      "type": "color",
      "id": "card_bg_color",
      "label": "Card Background Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "card_border_radius",
      "label": "Card Border Radius",
      "min": 0,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 12
    },
    {
      "type": "range",
      "id": "card_padding",
      "label": "Card Padding",
      "min": 10,
      "max": 50,
      "step": 2,
      "unit": "px",
      "default": 24
    },
    {
      "type": "range",
      "id": "content_spacing",
      "label": "Content Spacing",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "default": 16
    },
    {
      "type": "checkbox",
      "id": "enable_shadow",
      "label": "Enable Card Shadow",
      "default": true
    },
    {
      "type": "header",
      "content": "Typography Settings"
    },
    {
      "type": "range",
      "id": "heading_font_size",
      "label": "Heading Font Size (Desktop)",
      "min": 14,
      "max": 36,
      "step": 1,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "mobile_heading_font_size",
      "label": "Heading Font Size (Mobile)",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 18
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#000000"
    },
    {
      "type": "select",
      "id": "heading_font_weight",
      "label": "Heading Font Weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi Bold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "600"
    },
    {
      "type": "range",
      "id": "text_font_size",
      "label": "Text Font Size (Desktop)",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "range",
      "id": "mobile_text_font_size",
      "label": "Text Font Size (Mobile)",
      "min": 10,
      "max": 18,
      "step": 1,
      "unit": "px",
      "default": 14
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#333333"
    },
    {
      "type": "header",
      "content": "Navigation Settings"
    },
    {
      "type": "range",
      "id": "nav_button_size",
      "label": "Button Size (Desktop)",
      "min": 30,
      "max": 60,
      "step": 2,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "mobile_nav_button_size",
      "label": "Button Size (Mobile)",
      "min": 24,
      "max": 48,
      "step": 2,
      "unit": "px",
      "default": 32
    },
    {
      "type": "color",
      "id": "nav_button_color",
      "label": "Button Icon Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "nav_button_bg_color",
      "label": "Button Background Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "nav_button_opacity",
      "label": "Button Opacity",
      "min": 0.1,
      "max": 1,
      "step": 0.1,
      "default": 0.8
    },
    {
      "type": "color",
      "id": "dot_color",
      "label": "Dot Color",
      "default": "#000000"
    }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Card",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Card Title"
        },
        {
          "type": "textarea",
          "id": "content",
          "label": "Content",
          "default": "Card content goes here. You can add multiple paragraphs or any other content."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "PWC - Card Carousel #1",
      "category": "Custom",
      "blocks": [
        {
          "type": "card",
          "settings": {
            "title": "Space Fact 1",
            "content": "Jupiter protects Earth - its gravity acts like a cosmic shield, deflecting comets and asteroids."
          }
        },
        {
          "type": "card",
          "settings": {
            "title": "Space Fact 2",
            "content": "Stars \"beat\" like hearts - they pulsate, expanding and contracting as they burn fuel."
          }
        },
        {
          "type": "card",
          "settings": {
            "title": "Space Fact 3",
            "content": "Galaxies can \"eat\" each other - the Milky Way is currently consuming the Sagittarius Dwarf Galaxy."
          }
        },
        {
          "type": "card",
          "settings": {
            "title": "Space Fact 4",
            "content": "Space smells like seared steak - astronauts describe a metallic/grilled odor after spacewalks."
          }
        },
        {
          "type": "card",
          "settings": {
            "title": "Space Fact 5",
            "content": "Astronauts grow taller in space - spines stretch up to 2 inches without gravity's compression."
          }
        }
      ]
    }
  ]
}
{% endschema %}