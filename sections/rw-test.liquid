{%- assign sec_id = '#shopify-section-' | append: section.id -%}
{%- assign parts = sec_id | split: '_' -%}
{%- assign last_lower = parts | last -%}
{%- assign last_part = last_lower | downcase -%}

<style>
  {{ sec_id }} {
    width: 100%;
    padding: 40px 0;
    margin-top: {{ section.settings.section_margin_top }}px;
    margin-bottom: {{ section.settings.section_margin_bottom }}px;
    overflow: hidden;
  }
  
  {{ sec_id }} .pc-marquee-box-{{ last_part }} {
    transform: rotate(3.5deg);
    overflow: hidden;
    position: relative;
    padding: 10px 0;
  }
  
  {{ sec_id }} .pc-marquee-box-2-{{ last_part }} {
    transform: rotate(-2.5deg);
    overflow: hidden;
    position: relative;
    margin-top: 20px;
    padding: 10px 0;
  }
  
  {{ sec_id }} .pc-marquee-inner-{{ last_part }} {
    display: flex;
    white-space: nowrap;
    will-change: transform;
  }
  
  {{ sec_id }} .pc-marquee-inner-{{ last_part }} span {
    padding: 0 1rem;
    display: inline-block;
    flex-shrink: 0;
  }
  
  /* Animation for left-to-right */
  {{ sec_id }} .pc-marquee-left-{{ last_part }} .pc-marquee-inner-{{ last_part }} {
    animation: pc-marquee-left-anim-{{ last_part }} {{ section.settings.animation_speed }}s linear infinite;
  }
  
  /* Animation for right-to-left */
  {{ sec_id }} .pc-marquee-right-{{ last_part }} .pc-marquee-inner-{{ last_part }} {
    animation: pc-marquee-right-anim-{{ last_part }} {{ section.settings.animation_speed }}s linear infinite;
  }
  
  {{ sec_id }} .pc-pause-on-hover-{{ last_part }}:hover .pc-marquee-inner-{{ last_part }} {
    animation-play-state: paused;
  }
  
  @keyframes pc-marquee-left-anim-{{ last_part }} {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }
  
  @keyframes pc-marquee-right-anim-{{ last_part }} {
    0% { transform: translateX(-50%); }
    100% { transform: translateX(0); }
  }
  
  @media (max-width: 767px) {
    {{ sec_id }} {
      margin-top: {{ section.settings.section_margin_top_mobile }}px !important;
      margin-bottom: {{ section.settings.section_margin_bottom_mobile }}px !important;
    }

    {{ sec_id }} .pc-marquee-box-{{ last_part }} {
      font-size: {{ section.settings.layer1_font_size_mobile }}px !important;
      padding-top: {{ section.settings.layer1_padding_top_mobile }}px !important;
      padding-bottom: {{ section.settings.layer1_padding_bottom_mobile }}px !important;
    }

    {{ sec_id }} .pc-marquee-box-2-{{ last_part }} {
      font-size: {{ section.settings.layer2_font_size_mobile }}px !important;
      padding-top: {{ section.settings.layer2_padding_top_mobile }}px !important;
      padding-bottom: {{ section.settings.layer2_padding_bottom_mobile }}px !important;
    }
  }
</style>

<pc-marquee-section-{{ last_part }}>
  <!-- Layer 1 -->
  <div 
    class="pc-marquee-box-{{ last_part }} {% if section.settings.layer1_direction == 'right' %}pc-marquee-right-{{ last_part }}{% else %}pc-marquee-left-{{ last_part }}{% endif %} {% if section.settings.pause_on_hover %}pc-pause-on-hover-{{ last_part }}{% endif %}" 
    style="background-color: {{ section.settings.layer1_bg }};
           color: {{ section.settings.layer1_color }};
           font-size: {{ section.settings.layer1_font_size }}px;
           font-weight: {{ section.settings.layer1_font_weight }};
           font-style: {{ section.settings.layer1_font_style }};
           letter-spacing: {{ section.settings.layer1_letter_spacing }}px;
           text-decoration: {{ section.settings.layer1_text_decoration }};
           {% if section.settings.layer1_text_decoration != 'none' %}
             text-decoration-color: {{ section.settings.layer1_text_decoration_color }};
           {% endif %}
           padding-top: {{ section.settings.layer1_padding_top }}px;
           padding-bottom: {{ section.settings.layer1_padding_bottom }}px;">
    <div class="pc-marquee-inner-{{ last_part }}">
      {% for i in (1..3) %}
        {% for block in section.blocks %}
          {% if block.type == 'layer1_text' %}
            <span>{{ block.settings.text }}</span>
          {% endif %}
        {% endfor %}
      {% endfor %}
    </div>
  </div>
  
  <!-- Layer 2 -->
  <div 
    class="pc-marquee-box-2-{{ last_part }} {% if section.settings.layer2_direction == 'right' %}pc-marquee-right-{{ last_part }}{% else %}pc-marquee-left-{{ last_part }}{% endif %} {% if section.settings.pause_on_hover %}pc-pause-on-hover-{{ last_part }}{% endif %}" 
    style="background-color: {{ section.settings.layer2_bg }}; 
           color: {{ section.settings.layer2_color }};
           font-size: {{ section.settings.layer2_font_size }}px;
           font-weight: {{ section.settings.layer2_font_weight }};
           font-style: {{ section.settings.layer2_font_style }};
           letter-spacing: {{ section.settings.layer2_letter_spacing }}px;
           text-decoration: {{ section.settings.layer2_text_decoration }};
           {% if section.settings.layer2_text_decoration != 'none' %}
             text-decoration-color: {{ section.settings.layer2_text_decoration_color }};
           {% endif %}
           padding-top: {{ section.settings.layer2_padding_top }}px;
           padding-bottom: {{ section.settings.layer2_padding_bottom }}px;">
    <div class="pc-marquee-inner-{{ last_part }}">
      {% for i in (1..3) %}
        {% for block in section.blocks %}
          {% if block.type == 'layer2_text' %}
            <span>{{ block.settings.text }}</span>
          {% endif %}
        {% endfor %}
      {% endfor %}
    </div>
  </div>
</pc-marquee-section-{{ last_part }}>

{% schema %}
{
  "name": "PWC - Marquee Text #1",
  "settings": [
    {
      "type": "range",
      "id": "animation_speed",
      "label": "Animation Speed",
      "min": 5,
      "max": 30,
      "step": 1,
      "unit": "s",
      "default": 15
    },
    {
      "type": "range",
      "id": "section_margin_top",
      "label": "Section Margin Top (Desktop)",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "section_margin_bottom",
      "label": "Section Margin Bottom (Desktop)",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "section_margin_top_mobile",
      "label": "Section Margin Top (Mobile)",
      "min": 0,
      "max": 50,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "section_margin_bottom_mobile",
      "label": "Section Margin Bottom (Mobile)",
      "min": 0,
      "max": 50,
      "step": 5,
      "unit": "px",
      "default": 0
    },
    {
      "type": "header",
      "content": "Layer 1 Settings"
    },
    {
      "type": "color",
      "id": "layer1_bg",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "layer1_color",
      "label": "Text Color",
      "default": "#000000"
    },
    {
      "type": "select",
      "id": "layer1_direction",
      "label": "Direction",
      "options": [
        {"value": "left", "label": "Left to Right"},
        {"value": "right", "label": "Right to Left"}
      ],
      "default": "left"
    },
    {
      "type": "range",
      "id": "layer1_font_size",
      "label": "Font Size (Desktop)",
      "min": 6,
      "max": 50,
      "step": 2,
      "unit": "px",
      "default": 12
    },
    {
      "type": "range",
      "id": "layer1_font_size_mobile",
      "label": "Font Size (Mobile)",
      "min": 6,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 10
    },
    {
      "type": "select",
      "id": "layer1_font_weight",
      "label": "Font weight",
      "options": [
        {"value": "normal", "label": "Normal"},
        {"value": "bold", "label": "Bold"},
        {"value": "bolder", "label": "Bolder"},
        {"value": "lighter", "label": "Lighter"},
        {"value": "100", "label": "100"},
        {"value": "200", "label": "200"},
        {"value": "300", "label": "300"},
        {"value": "400", "label": "400"},
        {"value": "500", "label": "500"},
        {"value": "600", "label": "600"},
        {"value": "700", "label": "700"},
        {"value": "800", "label": "800"},
        {"value": "900", "label": "900"}
      ],
      "default": "normal"
    },
    {
      "type": "select",
      "id": "layer1_font_style",
      "label": "Font style",
      "options": [
        {"value": "normal", "label": "Normal"},
        {"value": "italic", "label": "Italic"},
        {"value": "oblique", "label": "Oblique"}
      ],
      "default": "normal"
    },
    {
      "type": "range",
      "id": "layer1_letter_spacing",
      "min": 0,
      "max": 10,
      "step": 0.5,
      "unit": "px",
      "label": "Letter spacing",
      "default": 0
    },
    {
      "type": "select",
      "id": "layer1_text_decoration",
      "label": "Text Decoration",
      "options": [
        {"value": "none", "label": "None"},
        {"value": "underline", "label": "Underline"},
        {"value": "overline", "label": "Overline"},
        {"value": "line-through", "label": "Line Through"}
      ],
      "default": "none"
    },
    {
      "type": "color",
      "id": "layer1_text_decoration_color",
      "label": "Text Decoration Color",
      "default": "#000"
    },
    {
      "type": "range",
      "id": "layer1_padding_top",
      "label": "Padding Top (Desktop)",
      "default": 5,
      "min": 0,
      "max": 150,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "layer1_padding_top_mobile",
      "label": "Padding Top (Mobile)",
      "default": 5,
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "layer1_padding_bottom",
      "label": "Padding Bottom (Desktop)",
      "default": 5,
      "min": 0,
      "max": 150,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "layer1_padding_bottom_mobile",
      "label": "Padding Bottom (Mobile)",
      "default": 5,
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Layer 2 Settings"
    },
    {
      "type": "color",
      "id": "layer2_bg",
      "label": "Background Color",
      "default": "#f0f0f0"
    },
    {
      "type": "color",
      "id": "layer2_color",
      "label": "Text Color",
      "default": "#000000"
    },
    {
      "type": "select",
      "id": "layer2_direction",
      "label": "Direction",
      "options": [
        {"value": "left", "label": "Left to Right"},
        {"value": "right", "label": "Right to Left"}
      ],
      "default": "right"
    },
    {
      "type": "range",
      "id": "layer2_font_size",
      "label": "Font Size (Desktop)",
      "min": 6,
      "max": 50,
      "step": 2,
      "unit": "px",
      "default": 12
    },
    {
      "type": "range",
      "id": "layer2_font_size_mobile",
      "label": "Font Size (Mobile)",
      "min": 6,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 10
    },
    {
      "type": "select",
      "id": "layer2_font_weight",
      "label": "Font weight",
      "options": [
        {"value": "normal", "label": "Normal"},
        {"value": "bold", "label": "Bold"},
        {"value": "bolder", "label": "Bolder"},
        {"value": "lighter", "label": "Lighter"},
        {"value": "100", "label": "100"},
        {"value": "200", "label": "200"},
        {"value": "300", "label": "300"},
        {"value": "400", "label": "400"},
        {"value": "500", "label": "500"},
        {"value": "600", "label": "600"},
        {"value": "700", "label": "700"},
        {"value": "800", "label": "800"},
        {"value": "900", "label": "900"}
      ],
      "default": "normal"
    },
    {
      "type": "select",
      "id": "layer2_font_style",
      "label": "Font style",
      "options": [
        {"value": "normal", "label": "Normal"},
        {"value": "italic", "label": "Italic"},
        {"value": "oblique", "label": "Oblique"}
      ],
      "default": "normal"
    },
    {
      "type": "range",
      "id": "layer2_letter_spacing",
      "min": 0,
      "max": 10,
      "step": 0.5,
      "unit": "px",
      "label": "Letter spacing",
      "default": 0
    },
    {
      "type": "select",
      "id": "layer2_text_decoration",
      "label": "Text Decoration",
      "options": [
        {"value": "none", "label": "None"},
        {"value": "underline", "label": "Underline"},
        {"value": "overline", "label": "Overline"},
        {"value": "line-through", "label": "Line Through"}
      ],
      "default": "none"
    },
    {
      "type": "color",
      "id": "layer2_text_decoration_color",
      "label": "Text Decoration Color",
      "default": "#000"
    },
    {
      "type": "range",
      "id": "layer2_padding_top",
      "label": "Padding Top (Desktop)",
      "default": 5,
      "min": 0,
      "max": 150,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "layer2_padding_top_mobile",
      "label": "Padding Top (Mobile)",
      "default": 15,
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "layer2_padding_bottom",
      "label": "Padding Bottom (Desktop)",
      "default": 15,
      "min": 0,
      "max": 150,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "layer2_padding_bottom_mobile",
      "label": "Padding Bottom (Mobile)",
      "default": 5,
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "checkbox",
      "id": "pause_on_hover",
      "label": "Pause on Hover",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "layer1_text",
      "name": "Layer 1 Text Item",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "Marquee text item"
        }
      ]
    },
    {
      "type": "layer2_text",
      "name": "Layer 2 Text Item",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "Marquee text item"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "PWC - Marquee Text #1",
      "category": "Custom",
      "blocks": [
        {
          "type": "layer1_text",
          "settings": {
            "text": "First marquee item"
          }
        },
        {
          "type": "layer1_text",
          "settings": {
            "text": "Second marquee item"
          }
        },
        {
          "type": "layer2_text",
          "settings": {
            "text": "First marquee item"
          }
        },
        {
          "type": "layer2_text",
          "settings": {
            "text": "Second marquee item"
          }
        }
      ]
    }
  ]
}
{% endschema %}