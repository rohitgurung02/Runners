{%- assign sec_id = '#shopify-section-' | append: section.id -%}
{%- assign parts = sec_id | split: '_' -%}
{%- assign last_lower = parts | last -%}
{%- assign last_part = last_lower | downcase -%}

<style>
  {{ sec_id }} {
    width: 100%;
    padding: 40px 0;
    margin-top: {{ section.settings.section_margin_top }}px;
    margin-bottom: {{ section.settings.section_margin_bottom }}px;
  }
  
  {{ sec_id }} .pc-marquee-box-{{ last_part }} {
    transform: rotate(3.5deg);
    overflow: hidden;
    position: relative;
    padding: 10px 0;
  }
  
  {{ sec_id }} .pc-marquee-box-2-{{ last_part }} {
    transform: rotate(-2.5deg);
    overflow: hidden;
    position: relative;
    margin-top: 20px;
    padding: 10px 0;
  }
  
  {{ sec_id }} .pc-marquee-{{ last_part }},
  {{ sec_id }} .pc-marquee-2-{{ last_part }} {
    display: flex;
    white-space: nowrap;
    width: max-content;
  }
  
  {{ sec_id }} .pc-marquee-{{ last_part }} span,
  {{ sec_id }} .pc-marquee-2-{{ last_part }} span {
    padding: 0 1rem;
    display: inline-block;
  }
  
  {{ sec_id }} .pc-marquee-{{ last_part }} {
    animation: pc-marquee-anim-{{ last_part }} 15s linear infinite;
  }
  
  {{ sec_id }} .pc-marquee-right-{{ last_part }} {
    animation: pc-marquee-right-anim-{{ last_part }} 15s linear infinite;
  }
  
  {{ sec_id }} .pc-marquee-2-{{ last_part }} {
    animation: pc-marquee-2-anim-{{ last_part }} 15s linear infinite;
  }
  
  {{ sec_id }} .pc-pause-on-hover-{{ last_part }}:hover {
    animation-play-state: paused;
  }
  
  @keyframes pc-marquee-anim-{{ last_part }} {
    0%   { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }
  
  @keyframes pc-marquee-right-anim-{{ last_part }} {
    0%   { transform: translateX(-50%); }
    100% { transform: translateX(0); }
  }
  
  @keyframes pc-marquee-2-anim-{{ last_part }} {
    0%   { transform: translateX(-50%); }
    100% { transform: translateX(0); }
  }
  
  @media (max-width: 767px) {
    {{ sec_id }} .pc-marquee-box-{{ last_part }},
    {{ sec_id }} .pc-marquee-box-2-{{ last_part }} {
      left: 0%;
    }
  }
</style>

<pc-marquee-section-{{ last_part }}>
  <div 
    class="pc-marquee-box-{{ last_part }}" 
    style="background-color: {{ section.settings.layer1_bg }}; color: {{ section.settings.layer1_color }};"
  >
    <div class="pc-marquee-{{ last_part }} {% if section.settings.pause_on_hover %}pc-pause-on-hover-{{ last_part }}{% endif %} {% if section.settings.layer1_direction == 'right' %}pc-marquee-right-{{ last_part }}{% endif %}">
      {% for i in (1..3) %}
        {% for block in section.blocks %}
          {% if block.type == 'layer1_text' %}
            <span>{{ block.settings.text }}</span>
          {% endif %}
        {% endfor %}
      {% endfor %}
    </div>
  </div>
  <div 
    class="pc-marquee-box-2-{{ last_part }}" 
    style="background-color: {{ section.settings.layer2_bg }}; color: {{ section.settings.layer2_color }};"
  >
    <div class="pc-marquee-2-{{ last_part }} {% if section.settings.pause_on_hover %}pc-pause-on-hover-{{ last_part }}{% endif %} {% if section.settings.layer2_direction == 'left' %}pc-marquee-left-{{ last_part }}{% endif %}">
      {% for i in (1..3) %}
        {% for block in section.blocks %}
          {% if block.type == 'layer2_text' %}
            <span>{{ block.settings.text }}</span>
          {% endif %}
        {% endfor %}
      {% endfor %}
    </div>
  </div>
</pc-marquee-section-{{ last_part }}>

{% schema %}
{
  "name": "Marquee Text",
  "max_blocks": 2,
  "settings": [
    {
      "type": "color",
      "id": "layer1_bg",
      "label": "Layer 1 Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "layer1_color",
      "label": "Layer 1 Text Color",
      "default": "#000000"
    },
    {
      "type": "select",
      "id": "layer1_direction",
      "label": "Layer 1 Direction",
      "options": [
        {
          "value": "left",
          "label": "Left to Right"
        },
        {
          "value": "right",
          "label": "Right to Left"
        }
      ],
      "default": "left"
    },
    {
      "type": "color",
      "id": "layer2_bg",
      "label": "Layer 2 Background Color",
      "default": "#f0f0f0"
    },
    {
      "type": "color",
      "id": "layer2_color",
      "label": "Layer 2 Text Color",
      "default": "#000000"
    },
    {
      "type": "select",
      "id": "layer2_direction",
      "label": "Layer 2 Direction",
      "options": [
        {
          "value": "left",
          "label": "Left to Right"
        },
        {
          "value": "right",
          "label": "Right to Left"
        }
      ],
      "default": "right"
    },
    {
      "type": "checkbox",
      "id": "pause_on_hover",
      "label": "Pause on Hover",
      "default": true
    },
     {
        "type": "range",
        "id": "section_margin_top",
        "label": "Margin Top (px)",
        "default": 10,
        "min": 0,
        "max": 150,
        "step": 5
      },
      {
        "type": "range",
        "id": "section_margin_bottom",
        "label": "Margin Bottom (px)",
        "default": 10,
        "min": 0,
        "max": 150,
        "step": 5
      },
  ],
  "blocks": [
    {
      "type": "layer1_text",
      "name": "Layer 1 Text Item",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Text"
        }
      ]
    },
    {
      "type": "layer2_text",
      "name": "Layer 2 Text Item",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Text"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Marquee Text",
      "category": "Custom"
    }
  ]
}
{% endschema %}