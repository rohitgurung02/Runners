{%- assign sec_id = '#shopify-section-' | append: section.id -%}
{%- assign parts = sec_id | split: '_' -%}
{%- assign last_lower = parts | last -%}
{%- assign last_part = last_lower | downcase -%}

<style>
  {{ sec_id }} .pc-parallax-effect-{{ last_part }} {
    position: relative;
    width: 100%;
    overflow: hidden;
  }

  @media only screen and (max-width: 767px) {
    .small--hide {
      display: none !important;
    }
  }

  @media only screen and (min-width: 768px) {
    .pc-txt-heading-{{ section.id }} {
      font-size: {{ section.settings.heading_size }}px;
      letter-spacing: {{ section.settings.letter_spacing }}px;
      font-weight: {{ section.settings.heading_weight }};
      color: {{ section.settings.heading_color }};
      margin-bottom: {{ section.settings.heading_margin_bottom }}px;
    }
    
    .pc-txt-subheading-{{ section.id }} {
      font-size: {{ section.settings.subheading_size }}px;
      letter-spacing: {{ section.settings.letter_spacing }}px;
      color: {{ section.settings.subheading_color }};
      margin-bottom: {{ section.settings.subheading_margin_bottom }}px;
    }
    
    .pc-button-{{ section.id }} {
      font-size: {{ section.settings.button_size }}px;
      letter-spacing: {{ section.settings.letter_spacing }}px;
      padding: {{ section.settings.button_padding_vertical }}px {{ section.settings.button_padding_horizontal }}px;
      background-color: {{ section.settings.button_bg_color }};
      color: {{ section.settings.button_text_color }};
      border-radius: {{ section.settings.button_border_radius }}px;
      border: {{ section.settings.button_border_width }}px solid {{ section.settings.button_border_color }};
      {% if section.settings.button_shadow %}
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      {% endif %}
    }
    
    .pc-parallax-container-{{ section.id }} {
      position: relative;
      z-index: 1;
      height: {{ section.settings.parallax_height }}px;
    }
    
    .pc-overlay-{{ section.id }}::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      background-color: {{ section.settings.overlay_color }};
      opacity: {{ section.settings.overlay_opacity }}%;
    }
    
    .pc-content-wrapper-{{ section.id }} {
      position: absolute;
      text-align: {{ section.settings.text_alignment }};
      top: {{ section.settings.text_vertical_position }}%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: {{ section.settings.text_width }}%;
      padding: {{ section.settings.content_padding }}px;
      background-color: {{ section.settings.content_bg_color }};
      border-radius: {{ section.settings.content_border_radius }}px;
    }
  }

  @media only screen and (max-width: 767px) {
    .pc-txt-heading-{{ section.id }} {
      font-size: {{ section.settings.mobile_heading_size }}px;
      margin-bottom: {{ section.settings.mobile_heading_margin_bottom }}px;
    }
    
    .pc-txt-subheading-{{ section.id }} {
      font-size: {{ section.settings.mobile_subheading_size }}px;
      margin-bottom: {{ section.settings.mobile_subheading_margin_bottom }}px;
    }
    
    .pc-button-{{ section.id }} {
      font-size: {{ section.settings.mobile_button_size }}px;
      padding: {{ section.settings.mobile_button_padding_vertical }}px {{ section.settings.mobile_button_padding_horizontal }}px;
    }
    
    .pc-parallax-container-{{ section.id }} {
      height: {{ section.settings.mobile_parallax_height }}px;
    }
    
    .pc-content-wrapper-{{ section.id }} {
      width: {{ section.settings.mobile_text_width }}%;
      padding: {{ section.settings.mobile_content_padding }}px;
    }
  }
</style>

<div class="small--hide {% if section.settings.full_width == blank %} page-width {% endif %}">
  {% for block in section.blocks limit: section.blocks.size %}
    <div class="pc-parallax-container-{{ section.id }} {% if section.settings.enable_overlay %} pc-overlay-{{ section.id }} {% endif %} lazyload"
      style="background-repeat: no-repeat; background-attachment: fixed; background-position: center top; background-size: cover;"
      data-expand="-40"
      data-bgset="{% if block.settings.image != blank %}{{ block.settings.image | img_url: 'master' }}{% else %}{{ 'product-1' | placeholder_svg_tag }}{% endif %}">
      
      {{- block.settings.image | image_url: width: block.settings.image.width, height: block.settings.image.height | image_tag: loading: 'lazy', preload: true, alt: block.settings.image.alt, class: 'pc-parallax-image' | replace: '<img', '<img style="width:100%; height:auto; object-fit:cover; min-height:' | append: section.settings.parallax_height | append: 'px;"' -}}
      
      <div class="pc-content-wrapper-{{ section.id }}">
        {% if block.settings.heading != blank %}
          {% if block.settings.heading_tag == 'h1' %}
            <h1 class="pc-txt-heading-{{ section.id }}">{{ block.settings.heading }}</h1>
          {% elsif block.settings.heading_tag == 'h2' %}
            <h2 class="pc-txt-heading-{{ section.id }}">{{ block.settings.heading }}</h2>
          {% else %}
            <h3 class="pc-txt-heading-{{ section.id }}">{{ block.settings.heading }}</h3>
          {% endif %}
        {% endif %}
        
        {% if block.settings.subheading != blank %}
          {% if block.settings.subheading_tag == 'h2' %}
            <h2 class="pc-txt-subheading-{{ section.id }}">{{ block.settings.subheading }}</h2>
          {% else %}
            <h3 class="pc-txt-subheading-{{ section.id }}">{{ block.settings.subheading }}</h3>
          {% endif %}
        {% endif %}
        
        {% if block.settings.show_button %}
          <a class="pc-button-{{ section.id }}" href="{{ block.settings.button_link }}" title="{{ block.settings.button_label | escape }}">
            {{ block.settings.button_label | escape }}
          </a>
        {% endif %}
      </div>
    </div>
  {% endfor %}
</div>

{% schema %}
{
  "name": "PWC - Parallax #1",
  "class": "shopify-section--pc-parallax",
  "settings": [
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full width",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_overlay",
      "label": "Enable overlay",
      "default": true
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Overlay color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Overlay opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 50
    },
    {
      "type": "range",
      "id": "parallax_height",
      "label": "Parallax height (desktop)",
      "min": 200,
      "max": 1000,
      "step": 10,
      "unit": "px",
      "default": 500
    },
    {
      "type": "range",
      "id": "mobile_parallax_height",
      "label": "Parallax height (mobile)",
      "min": 200,
      "max": 800,
      "step": 10,
      "unit": "px",
      "default": 300
    },
    {
      "type": "header",
      "content": "Content Settings"
    },
    {
      "type": "range",
      "id": "text_width",
      "label": "Text width (desktop)",
      "min": 30,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 80
    },
    {
      "type": "range",
      "id": "mobile_text_width",
      "label": "Text width (mobile)",
      "min": 50,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 90
    },
    {
      "type": "range",
      "id": "text_vertical_position",
      "label": "Text vertical position",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 50
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "content_padding",
      "label": "Content padding (desktop)",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 30
    },
    {
      "type": "range",
      "id": "mobile_content_padding",
      "label": "Content padding (mobile)",
      "min": 0,
      "max": 50,
      "step": 5,
      "unit": "px",
      "default": 20
    },
    {
      "type": "color",
      "id": "content_bg_color",
      "label": "Content background color",
      "default": "rgba(0,0,0,0)"
    },
    {
      "type": "range",
      "id": "content_border_radius",
      "label": "Content border radius",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "header",
      "content": "Typography Settings"
    },
    {
      "type": "range",
      "id": "heading_size",
      "label": "Heading size (desktop)",
      "min": 12,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 36
    },
    {
      "type": "range",
      "id": "mobile_heading_size",
      "label": "Heading size (mobile)",
      "min": 12,
      "max": 60,
      "step": 1,
      "unit": "px",
      "default": 24
    },
    {
      "type": "range",
      "id": "heading_weight",
      "label": "Heading font weight",
      "min": 300,
      "max": 900,
      "step": 100,
      "default": 700
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#FFFFFF"
    },
    {
      "type": "range",
      "id": "heading_margin_bottom",
      "label": "Heading margin bottom (desktop)",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "mobile_heading_margin_bottom",
      "label": "Heading margin bottom (mobile)",
      "min": 0,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 15
    },
    {
      "type": "range",
      "id": "subheading_size",
      "label": "Subheading size (desktop)",
      "min": 12,
      "max": 60,
      "step": 1,
      "unit": "px",
      "default": 18
    },
    {
      "type": "range",
      "id": "mobile_subheading_size",
      "label": "Subheading size (mobile)",
      "min": 12,
      "max": 40,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "color",
      "id": "subheading_color",
      "label": "Subheading color",
      "default": "#FFFFFF"
    },
    {
      "type": "range",
      "id": "subheading_margin_bottom",
      "label": "Subheading margin bottom (desktop)",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 30
    },
    {
      "type": "range",
      "id": "mobile_subheading_margin_bottom",
      "label": "Subheading margin bottom (mobile)",
      "min": 0,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "letter_spacing",
      "label": "Letter spacing",
      "min": 0,
      "max": 10,
      "step": 0.1,
      "unit": "px",
      "default": 1
    },
    {
      "type": "header",
      "content": "Button Settings"
    },
    {
      "type": "range",
      "id": "button_size",
      "label": "Button text size (desktop)",
      "min": 12,
      "max": 40,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "range",
      "id": "mobile_button_size",
      "label": "Button text size (mobile)",
      "min": 12,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 14
    },
    {
      "type": "range",
      "id": "button_padding_vertical",
      "label": "Button padding vertical (desktop)",
      "min": 5,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 12
    },
    {
      "type": "range",
      "id": "button_padding_horizontal",
      "label": "Button padding horizontal (desktop)",
      "min": 10,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 30
    },
    {
      "type": "range",
      "id": "mobile_button_padding_vertical",
      "label": "Button padding vertical (mobile)",
      "min": 5,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 10
    },
    {
      "type": "range",
      "id": "mobile_button_padding_horizontal",
      "label": "Button padding horizontal (mobile)",
      "min": 10,
      "max": 60,
      "step": 5,
      "unit": "px",
      "default": 20
    },
    {
      "type": "color",
      "id": "button_bg_color",
      "label": "Button background color",
      "default": "rgba(0,0,0,0)"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text color",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "button_border_color",
      "label": "Button border color",
      "default": "#FFFFFF"
    },
    {
      "type": "range",
      "id": "button_border_width",
      "label": "Button border width",
      "min": 0,
      "max": 10,
      "step": 1,
      "unit": "px",
      "default": 1
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "label": "Button border radius",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "checkbox",
      "id": "button_shadow",
      "label": "Button shadow",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "parallax_item",
      "name": "Parallax Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Parallax Heading"
        },
        {
          "type": "select",
          "id": "heading_tag",
          "label": "Heading tag",
          "options": [
            {
              "value": "h1",
              "label": "h1"
            },
            {
              "value": "h2",
              "label": "h2"
            },
            {
              "value": "h3",
              "label": "h3"
            }
          ],
          "default": "h2"
        },
        {
          "type": "text",
          "id": "subheading",
          "label": "Subheading",
          "default": "Parallax subheading text goes here"
        },
        {
          "type": "select",
          "id": "subheading_tag",
          "label": "Subheading tag",
          "options": [
            {
              "value": "h2",
              "label": "h2"
            },
            {
              "value": "h3",
              "label": "h3"
            }
          ],
          "default": "h3"
        },
        {
          "type": "checkbox",
          "id": "show_button",
          "label": "Show button",
          "default": true
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button label",
          "default": "Shop Now"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button link"
        }
      ]
    }
  ],
  "max_blocks": 3,
  "presets": [
    {
      "name": "PWC - Parallax #1",
      "category": "Image",
      "blocks": [
        {
          "type": "parallax_item"
        }
      ]
    }
  ]
}
{% endschema %}