{%- assign sec_id = '#shopify-section-' | append: section.id -%}
{%- assign parts = sec_id | split: '_' -%}
{%- assign last_lower = parts | last -%}
{%- assign last_part = last_lower | downcase -%}

<style>
  {{ sec_id }} {
    background-color: {{ section.settings.background_color }};
    padding: {{ section.settings.desktop_padding_top }}px 0 {{ section.settings.desktop_padding_bottom }}px;
    margin: {{ section.settings.desktop_margin_top }}px 0 {{ section.settings.desktop_margin_bottom }}px;
    {% if section.settings.shadow_enabled %}
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    {% endif %}
  }

  {{ sec_id }} .pc-timeline-{{ last_part }} {
    position: relative;
    max-width: 1200px;
    margin: 0 auto;
  }

  {{ sec_id }} .pc-timeline-{{ last_part }}::after {
    content: '';
    position: absolute;
    width: {{ section.settings.timeline_line_width }}px;
    background-color: {{ section.settings.timeline_line_color }};
    top: 0;
    bottom: 0;
    left: 50%;
    margin-left: -{{ section.settings.timeline_line_width | divided_by: 2 }}px;
    z-index: 1;
  }

  {{ sec_id }} .pc-timeline-container-{{ last_part }} {
    padding: 10px 40px;
    position: relative;
    background-color: inherit;
    width: 50%;
    clear: both;
  }

  {{ sec_id }} .pc-timeline-left-{{ last_part }} {
    float: left;
    left: 0;
  }

  {{ sec_id }} .pc-timeline-right-{{ last_part }} {
    float: right;
    left: 50%;
  }

  {{ sec_id }} .pc-timeline-container-{{ last_part }}::after {
    content: '';
    position: absolute;
    width: {{ section.settings.marker_size }}px;
    height: {{ section.settings.marker_size }}px;
    right: -{{ section.settings.marker_position }}px;
    background-color: {{ section.settings.marker_bg_color }};
    border: {{ section.settings.marker_border_width }}px solid {{ section.settings.marker_border_color }};
    top: 15px;
    border-radius: 50%;
    z-index: 2;
  }

  {{ sec_id }} .pc-timeline-right-{{ last_part }}::after {
    left: -{{ section.settings.marker_position | minus: 1 }}px;
  }

  {{ sec_id }} .pc-timeline-left-{{ last_part }}::before {
    content: " ";
    height: 0;
    position: absolute;
    top: 22px;
    width: 0;
    z-index: 1;
    right: {{ section.settings.arrow_position }}px;
    border: medium solid {{ section.settings.content_bg_color }};
    border-width: 10px 0 10px 10px;
    border-color: transparent transparent transparent {{ section.settings.content_bg_color }};
  }

  {{ sec_id }} .pc-timeline-right-{{ last_part }}::before {
    content: " ";
    height: 0;
    position: absolute;
    top: 22px;
    width: 0;
    z-index: 1;
    left: {{ section.settings.arrow_position }}px;
    border: medium solid {{ section.settings.content_bg_color }};
    border-width: 10px 10px 10px 0;
    border-color: transparent {{ section.settings.content_bg_color }} transparent transparent;
  }

  {{ sec_id }} .pc-timeline-content-{{ last_part }} {
    padding: 20px 30px;
    background-color: {{ section.settings.content_bg_color }};
    position: relative;
    border-radius: {{ section.settings.content_border_radius }}px;
  }

  {{ sec_id }} .pc-timeline-year-{{ last_part }} {
    font-size: {{ section.settings.year_font_size }}px;
    font-weight: {{ section.settings.year_font_weight }};
    color: {{ section.settings.year_color }};
    margin-bottom: 10px;
  }

  {{ sec_id }} .pc-timeline-text-{{ last_part }} {
    font-size: {{ section.settings.text_font_size }}px;
    line-height: 1.5;
    color: {{ section.settings.text_color }};
  }

  @media screen and (max-width: 600px) {
    {{ sec_id }} {
      padding: {{ section.settings.mobile_padding_top }}px 0 {{ section.settings.mobile_padding_bottom }}px;
      margin: {{ section.settings.mobile_margin_top }}px 0 {{ section.settings.mobile_margin_bottom }}px;
    }

    {{ sec_id }} .pc-timeline-{{ last_part }}::after {
      left: 31px;
    }

    {{ sec_id }} .pc-timeline-container-{{ last_part }} {
      width: 100%;
      padding-left: 70px;
      padding-right: 25px;
    }

    {{ sec_id }} .pc-timeline-container-{{ last_part }}::before {
      left: 60px;
      border: medium solid {{ section.settings.content_bg_color }};
      border-width: 10px 10px 10px 0;
      border-color: transparent {{ section.settings.content_bg_color }} transparent transparent;
    }

    {{ sec_id }} .pc-timeline-left-{{ last_part }}::after,
    {{ sec_id }} .pc-timeline-right-{{ last_part }}::after {
      left: 15px;
    }

    {{ sec_id }} .pc-timeline-right-{{ last_part }} {
      float: none;
      left: 0%;
    }
    
    {{ sec_id }} .pc-timeline-left-{{ last_part }} {
      float: none;
    }
  }
</style>

<div class="pc-timeline-{{ last_part }}">
  {% for block in section.blocks %}
    {%- assign mod_result = forloop.index0 | modulo: 2 -%}
    {%- if mod_result == 0 -%}
      <div class="pc-timeline-container-{{ last_part }} pc-timeline-left-{{ last_part }}" {{ block.shopify_attributes }}>
    {%- else -%}
      <div class="pc-timeline-container-{{ last_part }} pc-timeline-right-{{ last_part }}" {{ block.shopify_attributes }}>
    {%- endif -%}
      <div class="pc-timeline-content-{{ last_part }}">
        <h2 class="pc-timeline-year-{{ last_part }}">{{ block.settings.year }}</h2>
        <p class="pc-timeline-text-{{ last_part }}">{{ block.settings.text }}</p>
      </div>
    </div>
  {% endfor %}
  <div style="clear:both;"></div>
</div>

{% schema %}
{
  "name": "PWC - Timeline #2",
  "tag": "section",
  "class": "pc-timeline-section",
  "settings": [
    {
      "type": "header",
      "content": "Section Styling"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#252525"
    },
    {
      "type": "checkbox",
      "id": "shadow_enabled",
      "label": "Enable Shadow",
      "default": false
    },
    {
      "type": "header",
      "content": "Timeline Line"
    },
    {
      "type": "range",
      "id": "timeline_line_width",
      "label": "Line Width",
      "min": 1,
      "max": 10,
      "step": 1,
      "unit": "px",
      "default": 6
    },
    {
      "type": "color",
      "id": "timeline_line_color",
      "label": "Line Color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Timeline Marker"
    },
    {
      "type": "range",
      "id": "marker_size",
      "label": "Marker Size",
      "min": 10,
      "max": 40,
      "step": 1,
      "unit": "px",
      "default": 25
    },
    {
      "type": "range",
      "id": "marker_border_width",
      "label": "Marker Border Width",
      "min": 1,
      "max": 10,
      "step": 1,
      "unit": "px",
      "default": 4
    },
    {
      "type": "color",
      "id": "marker_bg_color",
      "label": "Marker Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "marker_border_color",
      "label": "Marker Border Color",
      "default": "#FF9F55"
    },
    {
      "type": "range",
      "id": "marker_position",
      "label": "Marker Position",
      "min": 10,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 17
    },
    {
      "type": "range",
      "id": "arrow_position",
      "label": "Arrow Position",
      "min": 10,
      "max": 40,
      "step": 1,
      "unit": "px",
      "default": 30
    },
    {
      "type": "header",
      "content": "Content Box"
    },
    {
      "type": "color",
      "id": "content_bg_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "content_border_radius",
      "label": "Border Radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 6
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "year_font_size",
      "label": "Year Font Size",
      "min": 12,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 24
    },
    {
      "type": "range",
      "id": "year_font_weight",
      "label": "Year Font Weight",
      "min": 100,
      "max": 900,
      "step": 100,
      "default": 700
    },
    {
      "type": "color",
      "id": "year_color",
      "label": "Year Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "text_font_size",
      "label": "Text Font Size",
      "min": 10,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#333333"
    },
    {
      "type": "header",
      "content": "Desktop Spacing"
    },
    {
      "type": "range",
      "id": "desktop_margin_top",
      "label": "Margin Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "desktop_margin_bottom",
      "label": "Margin Bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "desktop_padding_top",
      "label": "Padding Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 50
    },
    {
      "type": "range",
      "id": "desktop_padding_bottom",
      "label": "Padding Bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 50
    },
    {
      "type": "header",
      "content": "Mobile Spacing"
    },
    {
      "type": "range",
      "id": "mobile_margin_top",
      "label": "Margin Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "mobile_margin_bottom",
      "label": "Margin Bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "mobile_padding_top",
      "label": "Padding Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 30
    },
    {
      "type": "range",
      "id": "mobile_padding_bottom",
      "label": "Padding Bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 30
    }
  ],
  "blocks": [
    {
      "type": "timeline_item",
      "name": "Timeline Item",
      "settings": [
        {
          "type": "text",
          "id": "year",
          "label": "Year",
          "default": "2023"
        },
        {
          "type": "textarea",
          "id": "text",
          "label": "Text",
          "default": "Lorem ipsum dolor sit amet, quo ei simul congue exerci, ad nec admodum perfecto mnesarchum, vim ea mazim fierent detracto. Ea quis iuvaret expetendis his, te elit voluptua dignissim per, habeo iusto primis ea eam."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "PWC - Timeline #2",
      "category": "Custom",
      "blocks": [
        {
          "type": "timeline_item",
          "settings": {
            "year": "2023",
            "text": "Lorem ipsum dolor sit amet, quo ei simul congue exerci, ad nec admodum perfecto mnesarchum, vim ea mazim fierent detracto. Ea quis iuvaret expetendis his, te elit voluptua dignissim per, habeo iusto primis ea eam."
          }
        },
        {
          "type": "timeline_item",
          "settings": {
            "year": "2022",
            "text": "Lorem ipsum dolor sit amet, quo ei simul congue exerci, ad nec admodum perfecto mnesarchum, vim ea mazim fierent detracto."
          }
        },
        {
          "type": "timeline_item",
          "settings": {
            "year": "2021",
            "text": "Lorem ipsum dolor sit amet, quo ei simul congue exerci, ad nec admodum perfecto mnesarchum, vim ea mazim fierent detracto."
          }
        }
      ]
    }
  ]
}
{% endschema %}