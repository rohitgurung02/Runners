{%- assign sec_id = '#shopify-section-' | append: section.id -%}
{%- assign parts = sec_id | split: '_' -%}
{%- assign last_lower = parts | last -%}
{%- assign last_part = last_lower | downcase -%}

<style>
  {{ sec_id }} .pc-timeline-{{ last_part }} h1 {
    text-align: center;
    font-weight: {{ section.settings.heading_font_weight }};
    color: {{ section.settings.heading_color }};
    font-size: {{ section.settings.heading_font_size }}px;
    margin-bottom: {{ section.settings.heading_margin_bottom }}px;
  }

  {{ sec_id }} .pc-timeline-{{ last_part }} h1 span {
    font-weight: {{ section.settings.heading_span_font_weight }};
  }

  {{ sec_id }} .pc-timeline-{{ last_part }} {
    margin: {{ section.settings.desktop_margin_top }}px 0 {{ section.settings.desktop_margin_bottom }}px;
    padding: {{ section.settings.desktop_padding_top }}px {{ section.settings.desktop_padding_right }}px {{ section.settings.desktop_padding_bottom }}px {{ section.settings.desktop_padding_left }}px;
    background: {{ section.settings.background_color }};
    {% if section.settings.shadow_enabled %}
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    {% endif %}
  }

  {{ sec_id }} .pc-timeline-container-{{ last_part }} {
    display: flex;
    flex-direction: column;
  }

  {{ sec_id }} .pc-timeline-item-{{ last_part }} {
    width: calc(50% + 1px);
    padding: 0.5rem 2rem;
    position: relative;
  }

  {{ sec_id }} .pc-timeline-item-right-{{ last_part }} {
    align-self: flex-end;
    border-left: {{ section.settings.timeline_line_width }}px solid {{ section.settings.timeline_line_color }};
  }

  {{ sec_id }} .pc-timeline-item-left-{{ last_part }} {
    align-self: flex-start;
    border-right: {{ section.settings.timeline_line_width }}px solid {{ section.settings.timeline_line_color }};
  }

  {{ sec_id }} .pc-timeline-item-{{ last_part }}::after {
    content: "";
    position: absolute;
    width: {{ section.settings.marker_size }}px;
    height: {{ section.settings.marker_size }}px;
    border-radius: 50%;
    border: {{ section.settings.marker_border_width }}px solid {{ section.settings.marker_border_color }};
    background: {{ section.settings.marker_color }};
    z-index: 9999;
    top: 1.35rem;
  }

  {{ sec_id }} .pc-timeline-item-right-{{ last_part }}::after {
    left: -{{ section.settings.marker_position }}px;
  }

  {{ sec_id }} .pc-timeline-item-left-{{ last_part }}::after {
    right: -{{ section.settings.marker_position }}px;
  }

  {{ sec_id }} .pc-timeline-content-{{ last_part }} {
    width: 95%;
    padding: 0 15px;
    color: {{ section.settings.content_color }};
    display: flex;
    flex-direction: column;
  }

  {{ sec_id }} .pc-timeline-content-{{ last_part }} h3 {
    margin-top: 5px;
    margin-bottom: 5px;
    font-size: {{ section.settings.item_heading_font_size }}px;
    font-weight: {{ section.settings.item_heading_font_weight }};
    color: {{ section.settings.item_heading_color }};
  }

  {{ sec_id }} .pc-timeline-item-left-{{ last_part }} * {
    text-align: end;
  }

  {{ sec_id }} .pc-timeline-content-{{ last_part }} span {
    font-size: {{ section.settings.item_subheading_font_size }}px;
    color: {{ section.settings.item_subheading_color }};
  }

  {{ sec_id }} .pc-timeline-content-{{ last_part }} p {
    font-size: {{ section.settings.item_text_font_size }}px;
    line-height: 1.5em;
    word-spacing: 1px;
    color: {{ section.settings.item_text_color }};
  }

  @media screen and (max-width: 1024px) {
    {{ sec_id }} .pc-timeline-{{ last_part }} {
      margin: {{ section.settings.mobile_margin_top }}px 0 {{ section.settings.mobile_margin_bottom }}px;
      padding: {{ section.settings.mobile_padding_top }}px {{ section.settings.mobile_padding_right }}px {{ section.settings.mobile_padding_bottom }}px {{ section.settings.mobile_padding_left }}px;
    }

    {{ sec_id }} .pc-timeline-item-{{ last_part }} {
      width: 100%;
      padding: 1.35rem 2rem;
      border-right: none;
      border-left: {{ section.settings.timeline_line_width }}px solid {{ section.settings.timeline_line_color }};
    }

    {{ sec_id }} .pc-timeline-item-right-{{ last_part }} {
      align-self: flex-start;
    }

    {{ sec_id }} .pc-timeline-item-left-{{ last_part }} * {
      text-align: start;
    }

    {{ sec_id }} .pc-timeline-item-left-{{ last_part }}::after {
      right: auto;
      left: -{{ section.settings.marker_position }}px;
    }

    {{ sec_id }} .pc-timeline-item-{{ last_part }}::after {
      top: 2rem;
    }
  }
</style>

<div class="pc-timeline-{{ last_part }}">
  <h1>{{ section.settings.heading | replace: '[span]', '<span>' | replace: '[/span]', '</span>' }}</h1>

  <div class="pc-timeline-container-{{ last_part }}">
    {% for block in section.blocks %}
      <div class="pc-timeline-item-{{ last_part }} {% cycle 'pc-timeline-item-left-{{ last_part }}', 'pc-timeline-item-right-{{ last_part }}' %}" {{ block.shopify_attributes }}>
        <div class="pc-timeline-content-{{ last_part }}">
          {%- if block.settings.image != blank -%}
            <div class="pc-timeline-image-{{ last_part }}">
              {{- block.settings.image | image_url: width: block.settings.image.width, height: block.settings.image.height | image_tag: loading: 'lazy', preload: true, alt: block.settings.image.alt -}}
            </div>
          {%- endif -%}
          <h3>{{ block.settings.title }}</h3>
          <span>{{ block.settings.subtitle }}</span>
          <p>{{ block.settings.description }}</p>
        </div>
      </div>
    {% endfor %}
  </div>
</div>

{% schema %}
{
  "name": "RW - Timeline #1",
  "tag": "section",
  "class": "pc-timeline-section",
  "settings": [
    {
      "type": "header",
      "content": "Heading Settings"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Pure Css responsive [span]timeline[/span]",
      "info": "Use [span] and [/span] to highlight parts of text"
    },
    {
      "type": "range",
      "id": "heading_font_size",
      "label": "Heading Font Size (Desktop)",
      "min": 10,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 30
    },
    {
      "type": "range",
      "id": "heading_font_weight",
      "label": "Heading Font Weight",
      "min": 100,
      "max": 900,
      "step": 100,
      "default": 300
    },
    {
      "type": "range",
      "id": "heading_span_font_weight",
      "label": "Heading Span Font Weight",
      "min": 100,
      "max": 900,
      "step": 100,
      "default": 600
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#777777"
    },
    {
      "type": "range",
      "id": "heading_margin_bottom",
      "label": "Heading Margin Bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 30
    },
    {
      "type": "header",
      "content": "Timeline Style"
    },
    {
      "type": "range",
      "id": "timeline_line_width",
      "label": "Timeline Line Width",
      "min": 1,
      "max": 10,
      "step": 1,
      "unit": "px",
      "default": 2
    },
    {
      "type": "color",
      "id": "timeline_line_color",
      "label": "Timeline Line Color",
      "default": "#ccd1d9"
    },
    {
      "type": "range",
      "id": "marker_size",
      "label": "Marker Size",
      "min": 5,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "range",
      "id": "marker_border_width",
      "label": "Marker Border Width",
      "min": 1,
      "max": 5,
      "step": 1,
      "unit": "px",
      "default": 2
    },
    {
      "type": "color",
      "id": "marker_color",
      "label": "Marker Color",
      "default": "#4fc1e9"
    },
    {
      "type": "color",
      "id": "marker_border_color",
      "label": "Marker Border Color",
      "default": "#f5f7fa"
    },
    {
      "type": "range",
      "id": "marker_position",
      "label": "Marker Position",
      "min": 5,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 11
    },
    {
      "type": "header",
      "content": "Content Style"
    },
    {
      "type": "color",
      "id": "content_color",
      "label": "Content Color",
      "default": "#666666"
    },
    {
      "type": "range",
      "id": "item_heading_font_size",
      "label": "Item Heading Font Size",
      "min": 10,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 25
    },
    {
      "type": "range",
      "id": "item_heading_font_weight",
      "label": "Item Heading Font Weight",
      "min": 100,
      "max": 900,
      "step": 100,
      "default": 500
    },
    {
      "type": "color",
      "id": "item_heading_color",
      "label": "Item Heading Color",
      "default": "#666666"
    },
    {
      "type": "range",
      "id": "item_subheading_font_size",
      "label": "Item Subheading Font Size",
      "min": 10,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 15
    },
    {
      "type": "color",
      "id": "item_subheading_color",
      "label": "Item Subheading Color",
      "default": "#a4a4a4"
    },
    {
      "type": "range",
      "id": "item_text_font_size",
      "label": "Item Text Font Size",
      "min": 10,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 14
    },
    {
      "type": "color",
      "id": "item_text_color",
      "label": "Item Text Color",
      "default": "#888888"
    },
    {
      "type": "header",
      "content": "Section Styling"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#f1f2f6"
    },
    {
      "type": "checkbox",
      "id": "shadow_enabled",
      "label": "Enable Shadow",
      "default": false
    },
    {
      "type": "header",
      "content": "Desktop Spacing"
    },
    {
      "type": "range",
      "id": "desktop_margin_top",
      "label": "Margin Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "desktop_margin_bottom",
      "label": "Margin Bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "desktop_padding_top",
      "label": "Padding Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "desktop_padding_right",
      "label": "Padding Right",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 80
    },
    {
      "type": "range",
      "id": "desktop_padding_bottom",
      "label": "Padding Bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "desktop_padding_left",
      "label": "Padding Left",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 80
    },
    {
      "type": "header",
      "content": "Mobile Spacing"
    },
    {
      "type": "range",
      "id": "mobile_margin_top",
      "label": "Margin Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "mobile_margin_bottom",
      "label": "Margin Bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "mobile_padding_top",
      "label": "Padding Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 30
    },
    {
      "type": "range",
      "id": "mobile_padding_right",
      "label": "Padding Right",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "mobile_padding_bottom",
      "label": "Padding Bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 30
    },
    {
      "type": "range",
      "id": "mobile_padding_left",
      "label": "Padding Left",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 20
    }
  ],
  "blocks": [
    {
      "type": "timeline_item",
      "name": "Timeline Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image (Optional)"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Timeline Item"
        },
        {
          "type": "text",
          "id": "subtitle",
          "label": "Subtitle",
          "default": "Some work experience"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "RW - Timeline #1",
      "category": "Custom",
      "blocks": [
        {
          "type": "timeline_item",
          "settings": {
            "title": "First Year",
            "subtitle": "Some work experience",
            "description": "Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."
          }
        },
        {
          "type": "timeline_item",
          "settings": {
            "title": "Second Year",
            "subtitle": "More work experience",
            "description": "Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat."
          }
        },
        {
          "type": "timeline_item",
          "settings": {
            "title": "Third Year",
            "subtitle": "Advanced experience",
            "description": "Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur."
          }
        }
      ]
    }
  ]
}
{% endschema %}