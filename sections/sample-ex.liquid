{% style %}
  :root {
    --widget-width: 45em;
    --slider-thumb-position: 50%;
  }

  .image-comparison-container {
    max-width: calc(var(--widget-width) * 1.5);
    margin: auto;
    padding: 0.5em 1.5em;
    color: #1a202c;
    background-color: #fff5f5;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  }

  .image-comparison-container a {
    font-weight: bold;
    color: inherit;
  }

  .image-comparison-container h1 {
    color: #742a2a;
  }

  .image-comparison-widget {
    position: relative;
    width: var(--widget-width);
    height: calc(var(--widget-width) * 9 / 16);
    margin: auto;
  }

  .image-comparison-widget::before {
    content: url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><circle cx="12" cy="12" r="12" fill="%239b2c2c" /><path fill="white" d="M11,4h2v16h-2v-16zm-4,5l-3,3l3,3v-2h3v-2h-3zm13,3l-3,-3v2h-3v2h3v2z"/></svg>');
    position: absolute;
    left: calc(var(--slider-thumb-position) - 13px);
    top: 50%;
    z-index: 10;
    pointer-events: none;
    filter: drop-shadow(0 0 3px rgba(0, 0, 0, 0.5));
  }

  .image-comparison-widget img {
    display: block;
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    height: 100%;
    object-fit: cover;
    object-position: 0 50%;
    user-select: none;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }

  .image-comparison-widget .before-image {
    width: var(--slider-thumb-position);
    border-right: 3px solid #9b2c2c8f;
  }

  .image-comparison-widget .after-image {
    width: 100%;
  }

  .image-comparison-slider {
    position: absolute;
    margin: 0;
    width: 100%;
    height: 100%;
    left: 0;
    top: 0;
    cursor: ew-resize;
    -webkit-appearance: none;
    background: transparent;
  }

  .image-comparison-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 0;
    height: 0;
  }

  .image-comparison-slider::-moz-range-thumb {
    width: 0;
    height: 0;
  }

  .image-comparison-slider:focus {
    outline: none;
  }

  .image-comparison-instructions {
    margin-top: 1.8em;
  }

  .image-comparison-instructions a {
    text-decoration: underline #742a2a;
  }

  .image-comparison-footer {
    margin-top: 1.8em;
    text-align: center;
  }

  .image-comparison-footer a:not(:hover) {
    text-decoration: none;
  }
{% endstyle %}

<div class="image-comparison-container">
  <div class="image-comparison-widget" style="--slider-thumb-position: {{ slider_position | default: 50 }}%">
    <img class="after-image" src="{{ after_image | default: 'https://via.placeholder.com/800x450?text=After+Image' }}" alt="After">
    <img class="before-image" src="{{ before_image | default: 'https://via.placeholder.com/800x450?text=Before+Image' }}" alt="Before">
    <input type="range" class="image-comparison-slider" min="0" max="100" value="50">
  </div>

  <div class="image-comparison-instructions">
    <p>Follow these steps to play with the widget:</p>
    <ol>
      <li><a href="/account/login">Login</a> with your account</li>
      <li>Switch to <b>Edit</b> mode in your Shopify admin</li>
      <li>Change the images in the theme editor.</li>
    </ol>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const slider = document.querySelector('.image-comparison-slider');
  const beforeImage = document.querySelector('.before-image');
  const widget = document.querySelector('.image-comparison-widget');
  
  if (slider && beforeImage && widget) {
    slider.addEventListener('input', function(e) {
      const value = e.target.value;
      beforeImage.style.width = `${value}%`;
      widget.style.setProperty('--slider-thumb-position', value);
    });
  }
});
</script>