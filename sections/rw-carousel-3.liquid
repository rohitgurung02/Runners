{%- assign parts = sec_id | split: '_' -%}
{%- assign last_lower = parts | last -%}
{%- assign last_part = last_lower | downcase -%}

<style>
  {{ sec_id }} .pc-carousel-{{ last_part }} {
    position: relative;
    width: 100%;
    overflow: hidden;
    mask-image: linear-gradient(to right, transparent, #000 10% 90%, transparent);
  }

  {{ sec_id }} .pc-carousel-container-{{ last_part }} {
    display: flex;
    width: 100%;
    min-width: calc(var(--pc-item-width) * var(--pc-item-quantity));
    position: relative;
  }

  {{ sec_id }} .pc-carousel-item-{{ last_part }} {
    width: var(--pc-item-width);
    height: var(--pc-item-height);
    position: absolute;
    left: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: pc-slide-{{ last_part }} var(--pc-animation-duration) linear infinite;
    animation-delay: calc((var(--pc-animation-duration) / var(--pc-item-quantity)) * (var(--pc-item-position) - var(--pc-item-quantity)));
  }

  {{ sec_id }} .pc-carousel-{{ last_part }}[data-reverse="true"] .pc-carousel-item-{{ last_part }} {
    animation: pc-slide-reverse-{{ last_part }} var(--pc-animation-duration) linear infinite;
  }

  {{ sec_id }} .pc-carousel-{{ last_part }}:hover .pc-carousel-item-{{ last_part }} {
    animation-play-state: paused;
  }

  {{ sec_id }} .pc-carousel-img-{{ last_part }} {
    width: 100%;
    height: auto;
    max-height: var(--pc-item-height);
    object-fit: contain;
    filter: grayscale(100%);
    opacity: 0.7;
    transition: all 0.3s ease;
  }

  {{ sec_id }} .pc-carousel-img-{{ last_part }}:hover {
    filter: grayscale(0%);
    opacity: 1;
  }

  @keyframes pc-slide-{{ last_part }} {
    from {
      left: 100%;
    }
    to {
      left: calc(var(--pc-item-width) * -1);
    }
  }

  @keyframes pc-slide-reverse-{{ last_part }} {
    from {
      left: calc(var(--pc-item-width) * -1);
    }
    to {
      left: 100%;
    }
  }

  @media (max-width: 749px) {
    {{ sec_id }} .pc-carousel-{{ last_part }} {
      --pc-item-width: {{ section.settings.mobile_item_width }}px;
      --pc-item-height: {{ section.settings.mobile_item_height }}px;
    }
  }

  @media (min-width: 750px) {
    {{ sec_id }} .pc-carousel-{{ last_part }} {
      --pc-item-width: {{ section.settings.desktop_item_width }}px;
      --pc-item-height: {{ section.settings.desktop_item_height }}px;
    }
  }
</style>

<div class="pc-carousel-{{ last_part }}" 
     data-reverse="{{ section.settings.reverse_direction }}"
     style="--pc-item-quantity: {{ section.settings.brands.size }}; 
            --pc-animation-duration: {{ section.settings.animation_duration }}s">
  <div class="pc-carousel-container-{{ last_part }}">
    {% for brand in section.settings.brands %}
      <div class="pc-carousel-item-{{ last_part }}" style="--pc-item-position: {{ forloop.index }}">
        {% if brand.image != blank %}
          {{ brand.image | image_url: width: 200 | image_tag: 
            class: 'pc-carousel-img-' | append: last_part, 
            loading: 'lazy', 
            alt: brand.image.alt | escape 
          }}
        {% else %}
          {{ 'product-' | append: forloop.index | placeholder_svg_tag: 'pc-carousel-img-' | append: last_part }}
        {% endif %}
      </div>
    {% endfor %}
  </div>
</div>

{% schema %}
{
  "name": "PWC - Brand Carousel #1",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "range",
      "id": "animation_duration",
      "label": "Animation Duration (seconds)",
      "min": 5,
      "max": 60,
      "step": 1,
      "default": 15
    },
    {
      "type": "checkbox",
      "id": "reverse_direction",
      "label": "Reverse Animation Direction",
      "default": false
    },
    {
      "type": "header",
      "content": "Desktop Settings"
    },
    {
      "type": "range",
      "id": "desktop_item_width",
      "label": "Item Width (Desktop)",
      "min": 50,
      "max": 300,
      "step": 10,
      "unit": "px",
      "default": 120
    },
    {
      "type": "range",
      "id": "desktop_item_height",
      "label": "Item Height (Desktop)",
      "min": 20,
      "max": 200,
      "step": 5,
      "unit": "px",
      "default": 60
    },
    {
      "type": "header",
      "content": "Mobile Settings"
    },
    {
      "type": "range",
      "id": "mobile_item_width",
      "label": "Item Width (Mobile)",
      "min": 40,
      "max": 200,
      "step": 5,
      "unit": "px",
      "default": 80
    },
    {
      "type": "range",
      "id": "mobile_item_height",
      "label": "Item Height (Mobile)",
      "min": 15,
      "max": 150,
      "step": 5,
      "unit": "px",
      "default": 40
    },
    {
      "type": "header",
      "content": "Brand Logos"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Trusted by these brands"
    },
    {
      "type": "range",
      "id": "heading_font_size_desktop",
      "label": "Heading Font Size (Desktop)",
      "min": 12,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 24
    },
    {
      "type": "range",
      "id": "heading_font_size_mobile",
      "label": "Heading Font Size (Mobile)",
      "min": 10,
      "max": 30,
      "step": 1,
      "unit": "px",
      "default": 18
    },
    {
      "type": "checkbox",
      "id": "show_heading",
      "label": "Show Heading",
      "default": false
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "heading_margin_bottom",
      "label": "Heading Bottom Margin",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 20
    },
    {
      "type": "checkbox",
      "id": "heading_shadow",
      "label": "Heading Text Shadow",
      "default": false
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "desktop_padding_top",
      "label": "Top Padding (Desktop)",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "desktop_padding_bottom",
      "label": "Bottom Padding (Desktop)",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "mobile_padding_top",
      "label": "Top Padding (Mobile)",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "mobile_padding_bottom",
      "label": "Bottom Padding (Mobile)",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "default": 20
    }
  ],
  "blocks": [
    {
      "type": "brand",
      "name": "Brand",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Brand Logo"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "PWC - Brand Carousel #1",
      "blocks": [
        {
          "type": "brand"
        },
        {
          "type": "brand"
        },
        {
          "type": "brand"
        },
        {
          "type": "brand"
        },
        {
          "type": "brand"
        },
        {
          "type": "brand"
        }
      ]
    }
  ]
}
{% endschema %}